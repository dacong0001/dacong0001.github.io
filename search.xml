<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é“¾è¡¨ï¼ŒäºŒå‰æ ‘</title>
    <url>/2022/03/06/hello/</url>
    <content><![CDATA[<h1 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h1><h2 id="åˆ›å»ºé“¾è¡¨"><a href="#åˆ›å»ºé“¾è¡¨" class="headerlink" title="åˆ›å»ºé“¾è¡¨"></a>åˆ›å»ºé“¾è¡¨</h2><p><strong>ç”¨NodeèŠ‚ç‚¹æ¥è¿›è¡Œæ•°æ®ä¿å­˜ï¼Œåˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ç±»æ¥è¿›è¡Œç®¡ç†ï¼Œå®¢æˆ·ç«¯ä¸æ“ä½œNodeã€‚</strong>åº”è¯¥å¯¹Nodeç±»è¿›è¡ŒåŒ…è£…å¤„ç†ï¼Œå®šä¹‰å‡ºæ“ä½œæ ‡å‡†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ILink</span>&lt;E&gt;&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> Object [] toArray();</span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,Object data)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(E data)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E data)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clean</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinkImpl</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">ILink</span>&lt;E&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span>&#123;   <span class="comment">//ä¿å­˜èŠ‚ç‚¹çš„æ•°æ®å…³ç³»</span></span><br><span class="line">        <span class="keyword">private</span> E data;   <span class="comment">//ä¿å­˜æ•°æ®</span></span><br><span class="line">        <span class="keyword">private</span> Node next;    <span class="comment">//ä¿å­˜ä¸‹ä¸€ä¸ªå¼•ç”¨</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(E data)</span>&#123;  <span class="comment">//æœ‰æ•°æ®æ‰æœ‰æ„ä¹‰</span></span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">addNode</span><span class="params">(Node newNode)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.next == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="built_in">this</span>.next == newNode;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.next.addNode(newNode)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼š this = LinkImpl.root</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">toArrayNode</span><span class="params">()</span>&#123;</span><br><span class="line">            LinkImpl.<span class="built_in">this</span>.returnData[LinkImpl.<span class="built_in">this</span>.foot++] = <span class="built_in">this</span>.data;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.next)&#123;</span><br><span class="line">                <span class="built_in">this</span>.next.toArrayNode();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">getNode</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(LinkImpl.<span class="built_in">this</span>.foot++ == index)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.data;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.next.getNode(index);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNode</span><span class="params">(<span class="type">int</span> index,Object data)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(LinkImpl.<span class="built_in">this</span>.foot++ == index)&#123;</span><br><span class="line">                <span class="built_in">this</span>.data = data;  <span class="comment">//ä¿®æ”¹æ•°æ®</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.next.setNode(index,data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">containsNode</span><span class="params">(Object data)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.data.equals(data))&#123;    <span class="comment">//å¯¹è±¡æ¯”è¾ƒ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.next==<span class="literal">null</span>)&#123;   <span class="comment">//æ²¡æœ‰åç»­èŠ‚ç‚¹</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                    retrun  <span class="built_in">this</span>.next.containsNode(data);  <span class="comment">//å‘åç»§ç»­å¯»æ‰¾</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeNode</span><span class="params">(Node pre , E data)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.data.equals(data))&#123;</span><br><span class="line">                pre.next = <span class="built_in">this</span>.next;  <span class="comment">//ç©ºå‡ºå½“å‰èŠ‚ç‚¹</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">this</span>.next!=<span class="literal">null</span>)&#123;  <span class="comment">//æœ‰åç»­èŠ‚ç‚¹</span></span><br><span class="line">                    <span class="built_in">this</span>.next.removeNode(<span class="built_in">this</span>,data);  <span class="comment">//å‘åç»§ç»­åˆ é™¤</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  -----ä»¥ä¸‹ä¸ºLinkç±»ä¸­å®šä¹‰çš„æˆå‘˜-----</span></span><br><span class="line">    <span class="keyword">private</span> Node root;  <span class="comment">//ä¿å­˜æ ¹å…ƒç´ </span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> count;  <span class="comment">//ç»Ÿè®¡ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> foot;  <span class="comment">//å®šä¹‰ä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">private</span> Object [] returnData;  <span class="comment">//å®šä¹‰è¿”å›æ•°ç»„</span></span><br><span class="line">    <span class="comment">//  -----ä»¥ä¸‹ä¸ºLinkç±»ä¸­å®šä¹‰çš„æ–¹æ³•-----</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(e==<span class="literal">null</span>)&#123;   <span class="comment">//å¦‚æœä¿å­˜æ•°æ®ä¸ºç©ºè‡³æè¿”å›</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Node newNode <span class="keyword">new</span> <span class="title class_">Node</span>(e);  <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.root == <span class="literal">null</span>)&#123;       </span><br><span class="line">            <span class="built_in">this</span>.root = newNode;   <span class="comment">//å¦‚æœèŠ‚ç‚¹ä¸ºç©ºåˆ™å°†æ–°çš„èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.root.addNode(newNode);    <span class="comment">//å¦åˆ™å­˜å…¥ä¸‹ä¸€èŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count==<span class="number">0</span>;     <span class="comment">// 1.åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸º0</span></span><br><span class="line">       	<span class="comment">//return root==null;  //2.åˆ¤æ–­æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Object [] toArray()&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.root==<span class="literal">null</span>)&#123;    <span class="comment">//å¦‚æœä¸ºç©ºç›´æ¥è¿”å›</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.foot = <span class="number">0</span>;  <span class="comment">//è„šæ ‡æ¸…é›¶</span></span><br><span class="line">        <span class="built_in">this</span>.returnData = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="built_in">this</span>.count];  <span class="comment">//æ ¹æ®å·²æœ‰é•¿åº¦å¼€è¾Ÿæ•°ç»„</span></span><br><span class="line">        <span class="built_in">this</span>.root.toArrayNode();  <span class="comment">//è¿›è¡Œé€’å½’ä¿å­˜æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.returnData;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(index &gt;= <span class="built_in">this</span>.count)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.foot = <span class="number">0</span>; <span class="comment">//ç´¢å¼•æ¸…é›¶</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.root.getNode(index);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(<span class="type">int</span> index,Object data)</span>&#123;</span><br><span class="line">         <span class="keyword">if</span>(index &gt;= <span class="built_in">this</span>.count)&#123;</span><br><span class="line">            <span class="keyword">return</span>;  <span class="comment">//é€€å‡º</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.foot = <span class="number">0</span>; <span class="comment">//ç´¢å¼•æ¸…é›¶</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.root.setNode(index,data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object data)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="literal">null</span>) </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">//æ²¡æœ‰æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.root.containsNode(data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(E data)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.contains(data))&#123;  <span class="comment">//åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.root.data.equals(data))&#123;  <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">                <span class="built_in">this</span>.root = <span class="built_in">this</span>.root.next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">this</span>.root.next.removeNode(<span class="built_in">this</span>.root,data);  <span class="comment">//äº¤ä¸ªNodeç±»æ¥å¤„ç†</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.count--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.root = <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">this</span>.count = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<h1 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h1><h2 id="åè½¬é“¾è¡¨"><a href="#åè½¬é“¾è¡¨" class="headerlink" title="åè½¬é“¾è¡¨"></a>åè½¬é“¾è¡¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverse</span><span class="params">(ListNode head)</span> &#123;   <span class="comment">//head  : 1-&gt;2-&gt;3</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">prev</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> head.next;  <span class="comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹  2-&gt;3  // 3</span></span><br><span class="line">        head.next = prev;  <span class="comment">//head.next = null;    //head.next = 1</span></span><br><span class="line">        prev = head;    <span class="comment">// prev = 1 -&gt;null        //prev = 2-&gt;1-&gt;null</span></span><br><span class="line">        head = next;   <span class="comment">//  head = 2-&gt;3            //head = 3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> prev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸»è¦æ€æƒ³ä¸ºåˆ›å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ï¼Œè®©headèŠ‚ç‚¹çš„å†…å®¹ä¸€ç›´æŒ‡å‘æ–°é“¾è¡¨çš„å¤´éƒ¨</li>
</ul>
<h1 id="äºŒå‰æ ‘"><a href="#äºŒå‰æ ‘" class="headerlink" title="äºŒå‰æ ‘"></a>äºŒå‰æ ‘</h1><h2 id="äºŒå‰æ ‘çš„æ·±åº¦"><a href="#äºŒå‰æ ‘çš„æ·±åº¦" class="headerlink" title="äºŒå‰æ ‘çš„æ·±åº¦"></a>äºŒå‰æ ‘çš„æ·±åº¦</h2><h3 id="1-éå†"><a href="#1-éå†" class="headerlink" title="1.éå†"></a>1.éå†</h3><p>+++</p>
<h4 id="a-å…ˆåºéå†ï¼š"><a href="#a-å…ˆåºéå†ï¼š" class="headerlink" title="a.å…ˆåºéå†ï¼š"></a>a.å…ˆåºéå†ï¼š</h4><p> ä»–çš„è®¿é—®é¡ºåºæ˜¯ï¼šæ ¹èŠ‚ç‚¹â†’å·¦å­æ ‘â†’å³å­æ ‘ ï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(TreeNode tree)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree==<span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    System.out.println(tree.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    preOrder(root.left);</span><br><span class="line">    preOrder(root.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:carousel_horse:</p>
<h4 id="b-ä¸­åºéå†"><a href="#b-ä¸­åºéå†" class="headerlink" title="b.ä¸­åºéå†"></a>b.ä¸­åºéå†</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">(TreeNode tree)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree==<span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    inOrder(root.left);</span><br><span class="line">    System.out.println(root.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    inOrder(root.right);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:dog:</p>
<h4 id="c-ååºéå†"><a href="#c-ååºéå†" class="headerlink" title="c.ååºéå†"></a>c.ååºéå†</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lasrOrder</span><span class="params">(TreeNode tree)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree==<span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    lastOrder(tree.left);</span><br><span class="line">    lastOrder(tree.right);</span><br><span class="line">    System.out.println(root.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:cat2:</p>
<h3 id="2-é€’å½’æ±‚æ·±åº¦"><a href="#2-é€’å½’æ±‚æ·±åº¦" class="headerlink" title="2.é€’å½’æ±‚æ·±åº¦"></a>2.é€’å½’æ±‚æ·±åº¦</h3><p>+++</p>
 <img src="https://pic.leetcode-cn.com/f26ceb47110a4d431260a6af03c127027d9e1bdfd3980c553376734ca29fe545-image.png" alt="image.png" style="zoom: 67%;" /> 

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> root==<span class="literal">null</span>? <span class="number">0</span> : Math.max(maxDepth(root.left), maxDepth(root.right))+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-BFS"><a href="#3-BFS" class="headerlink" title="3.BFS"></a>3.BFS</h3><p>+++</p>
<p> BFSçš„å®ç°åŸç†å°±æ˜¯ä¸€å±‚å±‚éå†ï¼Œç»Ÿè®¡ä¸€ä¸‹æ€»å…±æœ‰å¤šå°‘å±‚ï¼Œæˆ‘ä»¬æ¥ç”»ä¸ªå›¾åˆ†æä¸€ä¸‹ã€‚ </p>
 <img src="https://pic.leetcode-cn.com/4d908dab4fe456418f3c06a124c4a0391c67f19780bfafc24d33878541faa665-image.png" alt="image.png" style="zoom:67%;" /> 

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        Deque&lt;TreeNode&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        deque.push(root);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!deque.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//æ¯ä¸€å±‚çš„ä¸ªæ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> deque.size();</span><br><span class="line">            <span class="keyword">while</span> (size-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> deque.pop();</span><br><span class="line">                <span class="keyword">if</span> (cur.left != <span class="literal">null</span>)</span><br><span class="line">                    deque.addLast(cur.left);</span><br><span class="line">                <span class="keyword">if</span> (cur.right != <span class="literal">null</span>)</span><br><span class="line">                    deque.addLast(cur.right);</span><br><span class="line">            &#125;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>Hadoop ç”Ÿäº§è°ƒä¼˜æ‰‹å†Œ</title>
    <url>/2022/03/06/Hadoop%EF%BC%88%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98%E6%89%8B%E5%86%8C%EF%BC%89/</url>
    <content><![CDATA[<h2 id="HDFSâ€”æ ¸å¿ƒå‚æ•°"><a href="#HDFSâ€”æ ¸å¿ƒå‚æ•°" class="headerlink" title="HDFSâ€”æ ¸å¿ƒå‚æ•°"></a>HDFSâ€”æ ¸å¿ƒå‚æ•°</h2><h3 id="NameNode-å†…å­˜ç”Ÿäº§é…ç½®"><a href="#NameNode-å†…å­˜ç”Ÿäº§é…ç½®" class="headerlink" title="NameNode å†…å­˜ç”Ÿäº§é…ç½®"></a>NameNode å†…å­˜ç”Ÿäº§é…ç½®</h3><p><strong>1ï¼‰NameNode å†…å­˜è®¡ç®—</strong><br>    æ¯ä¸ªæ–‡ä»¶å—å¤§æ¦‚å ç”¨ 150byteï¼Œä¸€å°æœåŠ¡å™¨ 128G å†…å­˜ä¸ºä¾‹ï¼Œèƒ½å­˜å‚¨å¤šå°‘æ–‡ä»¶å—å‘¢ï¼Ÿ<br>128 * 1024 * 1024 * 1024 &#x2F; 150Byte â‰ˆ 9.1 äº¿</p>
<p><strong>2ï¼‰Hadoop2.x ç³»åˆ—ï¼Œé…ç½® NameNode å†…å­˜</strong><br>    NameNode å†…å­˜é»˜è®¤ 2000mï¼Œå¦‚æœæœåŠ¡å™¨å†…å­˜ 4Gï¼ŒNameNode å†…å­˜å¯ä»¥é…ç½® 3gã€‚åœ¨<br>hadoop-env.sh æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ã€‚</p>
<p><code>HADOOP_NAMENODE_OPTS=-Xmx3072m</code> </p>
<p><strong>3ï¼‰Hadoop3.x ç³»åˆ—ï¼Œé…ç½® NameNode å†…å­˜</strong> </p>
<p>ï¼ˆ1ï¼‰hadoop-env.sh ä¸­æè¿° Hadoop çš„å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„</p>
<p>ï¼ˆ2ï¼‰æŸ¥çœ‹ NameNode å ç”¨å†…å­˜</p>
<p>[atguigu@hadoop102 ~]  jps<br>3088 NodeManager<br>2611 NameNode<br>3271 JobHistoryServer<br>2744 DataNode<br>3579 Jps<br>[atguigu@hadoop102 ~]â€‹  jmap -heap 2611<br>  Heap Configuration:<br> MaxHeapSize      &#x3D;           1031798784 (984.0MB)</p>
<p>æŸ¥çœ‹å‘ç° hadoop102 ä¸Šçš„ NameNode å’Œ DataNode å ç”¨å†…å­˜éƒ½æ˜¯è‡ªåŠ¨åˆ†é…çš„ï¼Œä¸”ç›¸ç­‰ã€‚ </p>
<p>ä¸æ˜¯å¾ˆåˆç†ã€‚<img src="/2022/03/06/Hadoop%EF%BC%88%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98%E6%89%8B%E5%86%8C%EF%BC%89/1646549131508-1646562909757.png" class="" width="1646549131508"></p>
<p>å…·ä½“ä¿®æ”¹ï¼šhadoop-env.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export HDFS_NAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS -</span><br><span class="line">Xmx1024m&quot;</span><br><span class="line">export HDFS_DATANODE_OPTS=&quot;-Dhadoop.security.logger=ERROR,RFAS</span><br><span class="line">-Xmx1024m&quot;</span><br></pre></td></tr></table></figure>

<h3 id="NameNode-å¿ƒè·³å¹¶å‘é…ç½®"><a href="#NameNode-å¿ƒè·³å¹¶å‘é…ç½®" class="headerlink" title="** NameNode** å¿ƒè·³å¹¶å‘é…ç½®"></a>** NameNode** <strong>å¿ƒè·³å¹¶å‘é…ç½®</strong></h3><p>NameNode æœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ± ï¼Œç”¨æ¥å¤„ç†ä¸åŒ DataNode çš„å¹¶å‘å¿ƒè·³ä»¥åŠå®¢æˆ·ç«¯å¹¶å‘<br>çš„å…ƒæ•°æ®æ“ä½œã€‚<br>å¯¹äºå¤§é›†ç¾¤æˆ–è€…æœ‰å¤§é‡å®¢æˆ·ç«¯çš„é›†ç¾¤æ¥è¯´ï¼Œé€šå¸¸éœ€è¦å¢å¤§è¯¥å‚æ•°ã€‚é»˜è®¤å€¼æ˜¯ 10ã€‚<br><property><br> <name>dfs.namenode.handler.count</name><br> <value>21</value><br></property></p>
<p>ä¼ä¸šç»éªŒï¼šdfs.namenode.handler.count&#x3D;20 Ã— ğ‘™ğ‘œğ‘”ğ‘’ ğ¶ğ‘™ğ‘¢ğ‘ ğ‘¡ğ‘’ğ‘Ÿ ğ‘†ğ‘–ğ‘§ğ‘’ï¼Œæ¯”å¦‚é›†ç¾¤è§„æ¨¡ï¼ˆDataNode å° </p>
<p>æ•°ï¼‰ä¸º 3 å°æ—¶ï¼Œæ­¤å‚æ•°è®¾ç½®ä¸º 21ã€‚å¯é€šè¿‡ç®€å•çš„ python ä»£ç è®¡ç®—è¯¥å€¼ï¼Œä»£ç å¦‚ä¸‹ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 ~]$ sudo yum install -y python</span><br><span class="line">[atguigu@hadoop102 ~]$ python</span><br><span class="line">Python 2.7.5 (default, Apr 11 2018, 07:36:10) </span><br><span class="line">[GCC 4.8.5 20150623 (Red Hat 4.8.5-28)] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more </span><br><span class="line">information.</span><br><span class="line">&gt;&gt;&gt; import math</span><br><span class="line">&gt;&gt;&gt; print int(20*math.log(3))</span><br><span class="line">21</span><br><span class="line">&gt;&gt;&gt; quit()</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å¯å›æ”¶ç«™é…ç½®"><a href="#å¼€å¯å›æ”¶ç«™é…ç½®" class="headerlink" title="å¼€å¯å›æ”¶ç«™é…ç½®"></a><strong>å¼€å¯å›æ”¶ç«™é…ç½®</strong></h3><p>â€‹    å¼€å¯å›æ”¶ç«™åŠŸèƒ½ï¼Œå¯ä»¥å°†åˆ é™¤çš„æ–‡ä»¶åœ¨ä¸è¶…æ—¶çš„æƒ…å†µä¸‹ï¼Œæ¢å¤åŸæ•°æ®ï¼Œèµ·åˆ°é˜²æ­¢è¯¯åˆ é™¤ã€ </p>
<p>å¤‡ä»½ç­‰ä½œç”¨ã€‚ </p>
<p><strong>1ï¼‰å›æ”¶ç«™å·¥ä½œæœºåˆ¶</strong></p>
å›æ”¶ç«™åŠŸèƒ½å‚æ•°è¯´æ˜**

<p>ï¼ˆ1ï¼‰é»˜è®¤å€¼ fs.trash.interval &#x3D; 0ï¼Œ0 è¡¨ç¤ºç¦ç”¨å›æ”¶ç«™ï¼›å…¶ä»–å€¼è¡¨ç¤ºè®¾ç½®æ–‡ä»¶çš„å­˜æ´»æ—¶é—´ã€‚ </p>
<p>ï¼ˆ2ï¼‰é»˜è®¤å€¼ fs.trash.checkpoint.interval &#x3D; 0ï¼Œæ£€æŸ¥å›æ”¶ç«™çš„é—´éš”æ—¶é—´ã€‚å¦‚æœè¯¥å€¼ä¸º 0ï¼Œåˆ™è¯¥ </p>
<p>å€¼è®¾ç½®å’Œ fs.trash.interval çš„å‚æ•°å€¼ç›¸ç­‰ã€‚ </p>
<p>ï¼ˆ3ï¼‰è¦æ±‚ fs.trash.checkpoint.interval &lt;&#x3D; fs.trash.interval.</p>
<p><strong>3ï¼‰å¯ç”¨å›æ”¶ç«™</strong></p>
<p>ä¿®æ”¹ core-site.xmlï¼Œé…ç½®åƒåœ¾å›æ”¶æ—¶é—´ä¸º 1 åˆ†é’Ÿã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;fs.trash.interval&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p><strong>4ï¼‰</strong>æŸ¥çœ‹å›æ”¶ç«™ </p>
<p>â€‹    å›æ”¶ç«™ç›®å½•åœ¨ HDFS é›†ç¾¤ä¸­çš„è·¯å¾„ï¼š&#x2F;user&#x2F;atguigu&#x2F;.Trash&#x2F;â€¦. </p>
<p><strong>5ï¼‰</strong>æ³¨æ„ï¼šé€šè¿‡ç½‘é¡µä¸Šç›´æ¥åˆ é™¤çš„æ–‡ä»¶ä¹Ÿä¸ä¼šèµ°å›æ”¶ç«™ã€‚ </p>
<p><strong>6ï¼‰</strong>é€šè¿‡ç¨‹åºåˆ é™¤çš„æ–‡ä»¶ä¸ä¼šç»è¿‡å›æ”¶ç«™ï¼Œéœ€è¦è°ƒç”¨ moveToTrash()æ‰è¿›å…¥å›æ”¶ç«™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Trash trash = New Trash(conf);</span><br><span class="line">trash.moveToTrash(path);</span><br></pre></td></tr></table></figure>

<p><strong>7ï¼‰</strong>åªæœ‰åœ¨å‘½ä»¤è¡Œåˆ©ç”¨ hadoop fs -rm å‘½ä»¤åˆ é™¤çš„æ–‡ä»¶æ‰ä¼šèµ°å›æ”¶ç«™ã€‚</p>
<p><strong>8ï¼‰</strong>æ¢å¤å›æ”¶ç«™æ•°æ®ï¼Œæ˜¯æ‰¾åˆ°å›æ”¶è·¯å¾„æŠŠä»–copyæˆ–ç§»åŠ¨å‡ºæ¥</p>
<h2 id="HDFSâ€”é›†ç¾¤å‹æµ‹"><a href="#HDFSâ€”é›†ç¾¤å‹æµ‹" class="headerlink" title="HDFSâ€”é›†ç¾¤å‹æµ‹"></a>HDFSâ€”é›†ç¾¤å‹æµ‹</h2><p>åœ¨ä¼ä¸šä¸­éå¸¸å…³å¿ƒæ¯å¤©ä» Java åå°æ‹‰å–è¿‡æ¥çš„æ•°æ®ï¼Œéœ€è¦å¤šä¹…èƒ½ä¸Šä¼ åˆ°é›†ç¾¤ï¼Ÿæ¶ˆè´¹è€… å…³å¿ƒå¤šä¹…èƒ½ä» HDFS ä¸Šæ‹‰å–éœ€è¦çš„æ•°æ®ï¼Ÿ </p>
<p>ä¸ºäº†ææ¸…æ¥š HDFS çš„è¯»å†™æ€§èƒ½ï¼Œç”Ÿäº§ç¯å¢ƒä¸Šéå¸¸éœ€è¦å¯¹é›†ç¾¤è¿›è¡Œå‹æµ‹ã€‚</p>
<p>â¢ <strong>Number of filesï¼š</strong>ç”Ÿæˆ mapTask æ•°é‡ï¼Œä¸€èˆ¬æ˜¯é›†ç¾¤ä¸­ï¼ˆCPU æ ¸æ•°-1ï¼‰ï¼Œæˆ‘ä»¬æµ‹è¯•è™š æ‹Ÿæœºå°±æŒ‰ç…§å®é™…çš„ç‰©ç†å†…å­˜-1 åˆ†é…å³å¯ </p>
<p>â¢ T<strong>otal MBytes processed****ï¼š</strong>å•ä¸ª map å¤„ç†çš„æ–‡ä»¶å¤§å° </p>
<p>â¢ **Throughput mb&#x2F;sec:**å•ä¸ª mapTak çš„ååé‡ </p>
<p>è®¡ç®—æ–¹å¼ï¼šå¤„ç†çš„æ€»æ–‡ä»¶å¤§å°&#x2F;æ¯ä¸€ä¸ª mapTask å†™æ•°æ®çš„æ—¶é—´ç´¯åŠ  </p>
<p>é›†ç¾¤æ•´ä½“ååé‡ï¼šç”Ÿæˆ mapTask æ•°é‡*å•ä¸ª mapTak çš„ååé‡ </p>
<p>â¢ <strong>Average IO rate mb&#x2F;sec:</strong> å¹³å‡ mapTak çš„ååé‡ </p>
<p>è®¡ç®—æ–¹å¼ï¼šæ¯ä¸ª mapTask å¤„ç†æ–‡ä»¶å¤§å°&#x2F;æ¯ä¸€ä¸ª mapTask å†™æ•°æ®çš„æ—¶é—´å…¨éƒ¨ç›¸åŠ é™¤ä»¥ task æ•°é‡ </p>
<p>â¢ <strong>IO rate std deviation:</strong> æ–¹å·®ã€åæ˜ å„ä¸ª mapTask å¤„ç†çš„å·®å€¼ï¼Œè¶Šå°è¶Šå‡è¡¡</p>
<p><strong>1ï¼‰æµ‹è¯•å†…å®¹ï¼šå‘ HDFS é›†ç¾¤å†™ 10 ä¸ª 128M çš„æ–‡ä»¶</strong></p>
<p><img src="C:\Users\26959\AppData\Roaming\Typora\typora-user-images\1646549566406.png" alt="1646549566406"></p>
<p><strong>2ï¼‰æ³¨æ„ï¼šå¦‚æœæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå‡ºç°å¼‚å¸¸</strong> </p>
<p>(1ï¼‰å¯ä»¥åœ¨ yarn-site.xml ä¸­è®¾ç½®è™šæ‹Ÿå†…å­˜æ£€æµ‹ä¸º false</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--æ˜¯å¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ­£ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜é‡ï¼Œå¦‚æœä»»åŠ¡è¶…å‡ºåˆ†é…å€¼ï¼Œåˆ™</span><br><span class="line">ç›´æ¥å°†å…¶æ€æ‰ï¼Œé»˜è®¤æ˜¯ true --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>(2ï¼‰åˆ†å‘é…ç½®å¹¶é‡å¯ Yarn é›†ç¾¤</p>
<p><strong>3ï¼‰æµ‹è¯•ç»“æœåˆ†æ</strong></p>
<p>ï¼ˆ1ï¼‰ç”±äºå‰¯æœ¬ 1 å°±åœ¨æœ¬åœ°ï¼Œæ‰€ä»¥è¯¥å‰¯æœ¬ä¸å‚ä¸æµ‹è¯• </p>
<p>ä¸€å…±å‚ä¸æµ‹è¯•çš„æ–‡ä»¶ï¼š10 ä¸ªæ–‡ä»¶ * 2 ä¸ªå‰¯æœ¬ &#x3D; 20 ä¸ª </p>
<p>å‹æµ‹åçš„é€Ÿåº¦ï¼š1.61 </p>
<p>å®æµ‹é€Ÿåº¦ï¼š1.61M&#x2F;s * 20 ä¸ªæ–‡ä»¶ â‰ˆ 32M&#x2F;s </p>
<p>ä¸‰å°æœåŠ¡å™¨çš„å¸¦å®½ï¼š12.5 + 12.5 + 12.5 â‰ˆ 30m&#x2F;s </p>
<p>æ‰€æœ‰ç½‘ç»œèµ„æºéƒ½å·²ç»ç”¨æ»¡ã€‚ </p>
<p><strong>å¦‚æœå®æµ‹é€Ÿåº¦è¿œè¿œå°äºç½‘ç»œï¼Œå¹¶ä¸”å®æµ‹é€Ÿåº¦ä¸èƒ½æ»¡è¶³å·¥ä½œéœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨å›ºæ€ç¡¬ç›˜</strong> </p>
<p><strong>æˆ–è€…å¢åŠ ç£ç›˜ä¸ªæ•°ã€‚</strong> </p>
<p>ï¼ˆ2ï¼‰å¦‚æœå®¢æˆ·ç«¯ä¸åœ¨é›†ç¾¤èŠ‚ç‚¹ï¼Œé‚£å°±ä¸‰ä¸ªå‰¯æœ¬éƒ½å‚ä¸è®¡ç®—</p>
<h2 id="HDFSâ€”å¤šç›®å½•"><a href="#HDFSâ€”å¤šç›®å½•" class="headerlink" title="HDFSâ€”å¤šç›®å½•"></a>HDFSâ€”å¤šç›®å½•</h2><p>1ï¼‰NameNode çš„æœ¬åœ°ç›®å½•å¯ä»¥é…ç½®æˆå¤šä¸ªï¼Œä¸”æ¯ä¸ªç›®å½•å­˜æ”¾å†…å®¹ç›¸åŒï¼Œå¢åŠ äº†å¯é æ€§</p>
<p>2ï¼‰å…·ä½“é…ç½®å¦‚ä¸‹</p>
<p>â€‹        1.åœ¨ hdfs-site.xml æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br><span class="line"> </span><br><span class="line">&lt;value&gt;file://$&#123;hadoop.tmp.dir&#125;/dfs/name1,file://$&#123;hadoop.tmp.</span><br><span class="line">dir&#125;/dfs/name2&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>â€‹        2.åœæ­¢é›†ç¾¤ï¼Œåˆ é™¤ä¸‰å°èŠ‚ç‚¹çš„ data å’Œ logs ä¸­æ‰€æœ‰æ•°æ®.</p>
<p>â€‹        3.æ ¼å¼åŒ–é›†ç¾¤å¹¶å¯åŠ¨ã€‚ </p>
<p>3)DataNodeçš„å¤šç›®å½•é…ç½®ä¸€æ ·ï¼Œåªä¸è¿‡ä¸éœ€è¦åˆ é™¤æ•°æ®å’Œæ ¼å¼åŒ–</p>
<h3 id="é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡"><a href="#é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡" class="headerlink" title="é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡"></a><strong>é›†ç¾¤æ•°æ®å‡è¡¡ä¹‹ç£ç›˜é—´æ•°æ®å‡è¡¡</strong></h3><p>ç”Ÿäº§ç¯å¢ƒï¼Œç”±äºç¡¬ç›˜ç©ºé—´ä¸è¶³ï¼Œå¾€å¾€éœ€è¦å¢åŠ ä¸€å—ç¡¬ç›˜ã€‚åˆšåŠ è½½çš„ç¡¬ç›˜æ²¡æœ‰æ•°æ®æ—¶ï¼Œå¯<br>ä»¥æ‰§è¡Œç£ç›˜æ•°æ®å‡è¡¡å‘½ä»¤ã€‚ï¼ˆHadoop3.x æ–°ç‰¹æ€§ï¼‰</p>
<p>ï¼ˆ1ï¼‰ç”Ÿæˆå‡è¡¡è®¡åˆ’ï¼ˆ<strong>æˆ‘ä»¬åªæœ‰ä¸€å—ç£ç›˜ï¼Œä¸ä¼šç”Ÿæˆè®¡åˆ’</strong>ï¼‰ </p>
<p><code>hdfs diskbalancer -plan hadoop103</code> </p>
<p>ï¼ˆ2ï¼‰æ‰§è¡Œå‡è¡¡è®¡åˆ’ </p>
<p><code>hdfs diskbalancer -execute hadoop103.plan.json</code> </p>
<p>ï¼ˆ3ï¼‰æŸ¥çœ‹å½“å‰å‡è¡¡ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µ </p>
<p><code>hdfs diskbalancer -query hadoop103</code> </p>
<p>ï¼ˆ4ï¼‰å–æ¶ˆå‡è¡¡ä»»åŠ¡ </p>
<p><code>hdfs diskbalancer -cancel hadoop103.plan.json</code> </p>
<h2 id="HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹"><a href="#HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹" class="headerlink" title="HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹"></a>HDFSâ€”é›†ç¾¤æ‰©å®¹åŠç¼©å®¹</h2><h3 id="æ·»åŠ ç™½åå•"><a href="#æ·»åŠ ç™½åå•" class="headerlink" title="æ·»åŠ ç™½åå•"></a><strong>æ·»åŠ ç™½åå•</strong></h3><p>ç™½åå•ï¼šè¡¨ç¤ºåœ¨ç™½åå•çš„ä¸»æœº IP åœ°å€å¯ä»¥ï¼Œç”¨æ¥å­˜å‚¨æ•°æ®ã€‚ </p>
<p>ä¼ä¸šä¸­ï¼šé…ç½®ç™½åå•ï¼Œå¯ä»¥å°½é‡é˜²æ­¢é»‘å®¢æ¶æ„è®¿é—®æ”»å‡»ã€‚ </p>
<p>é…ç½®ç™½åå•æ­¥éª¤å¦‚ä¸‹ï¼š </p>
<p>1ï¼‰åœ¨ NameNode èŠ‚ç‚¹çš„&#x2F;opt&#x2F;module&#x2F;hadoop-3.1.3&#x2F;etc&#x2F;hadoop ç›®å½•ä¸‹åˆ†åˆ«åˆ›å»º whitelist å’Œ </p>
<p>blacklist æ–‡ä»¶ </p>
<p>ï¼ˆ1ï¼‰åˆ›å»ºç™½åå• </p>
<p><code>[atguigu@hadoop102 hadoop]$ vim whitelist</code> </p>
<p>åœ¨ whitelist ä¸­æ·»åŠ å¦‚ä¸‹ä¸»æœºåç§°ï¼Œå‡å¦‚é›†ç¾¤æ­£å¸¸å·¥ä½œçš„èŠ‚ç‚¹ä¸º 102 103 </p>
<p>ï¼ˆ2ï¼‰åˆ›å»ºé»‘åå• </p>
<p><code>[atguigu@hadoop102 hadoop]$ touch blacklist</code> </p>
<p>ä¿æŒç©ºçš„å°±å¯ä»¥</p>
<p>2ï¼‰åœ¨ hdfs-site.xml é…ç½®æ–‡ä»¶ä¸­å¢åŠ  dfs.hosts é…ç½®å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- ç™½åå• --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;dfs.hosts&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;/opt/module/hadoop-3.1.3/etc/hadoop/whitelist&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!-- é»‘åå• --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line"> &lt;name&gt;dfs.hosts.exclude&lt;/name&gt;</span><br><span class="line"> &lt;value&gt;/opt/module/hadoop-3.1.3/etc/hadoop/blacklist&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>3ï¼‰åˆ†å‘é…ç½®æ–‡ä»¶ whitelistï¼Œhdfs-site.xml </p>
<p><code>[atguigu@hadoop104 hadoop]$ xsync hdfs-site.xml whitelist</code> </p>
<p>4ï¼‰ç¬¬ä¸€æ¬¡æ·»åŠ ç™½åå•å¿…é¡»é‡å¯é›†ç¾¤ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œåªéœ€è¦åˆ·æ–° NameNode èŠ‚ç‚¹å³å¯ </p>
<p><code>[atguigu@hadoop102 hadoop-3.1.3]$ myhadoop.sh stop</code> </p>
<p><code>[atguigu@hadoop102 hadoop-3.1.3]$ myhadoop.sh start</code> </p>
<h3 id="æœå½¹æ–°æœåŠ¡å™¨"><a href="#æœå½¹æ–°æœåŠ¡å™¨" class="headerlink" title="æœå½¹æ–°æœåŠ¡å™¨"></a><strong>æœå½¹æ–°æœåŠ¡å™¨</strong></h3><p>1ï¼‰éœ€æ±‚ </p>
<p>â€‹    éšç€å…¬å¸ä¸šåŠ¡çš„å¢é•¿ï¼Œæ•°æ®é‡è¶Šæ¥è¶Šå¤§ï¼ŒåŸæœ‰çš„æ•°æ®èŠ‚ç‚¹çš„å®¹é‡å·²ç»ä¸èƒ½æ»¡è¶³å­˜å‚¨æ•°æ® </p>
<p>çš„éœ€æ±‚ï¼Œéœ€è¦åœ¨åŸæœ‰é›†ç¾¤åŸºç¡€ä¸ŠåŠ¨æ€æ·»åŠ æ–°çš„æ•°æ®èŠ‚ç‚¹.</p>
<p>2ï¼‰ç¯å¢ƒå‡†å¤‡ </p>
<p>ï¼ˆ1ï¼‰åœ¨ hadoop100 ä¸»æœºä¸Šå†å…‹éš†ä¸€å° hadoop105 ä¸»æœº </p>
<p>ï¼ˆ2ï¼‰ä¿®æ”¹ IP åœ°å€å’Œä¸»æœºåç§°</p>
<p>ï¼ˆ3ï¼‰æ‹·è´ hadoop102 çš„&#x2F;opt&#x2F;module ç›®å½•å’Œ&#x2F;etc&#x2F;profile.d&#x2F;my_env.sh åˆ° hadoop105</p>
<p>ï¼ˆ4ï¼‰åˆ é™¤ hadoop105 ä¸Š Hadoop çš„å†å²æ•°æ®ï¼Œdata å’Œ log æ•°æ® </p>
<p>ï¼ˆ5ï¼‰é…ç½® hadoop102 å’Œ hadoop103 åˆ° hadoop105 çš„ ssh æ— å¯†ç™»å½• </p>
<p>3ï¼‰æœå½¹æ–°èŠ‚ç‚¹å…·ä½“æ­¥éª¤ </p>
<p>ï¼ˆ1ï¼‰ç›´æ¥å¯åŠ¨ DataNodeï¼Œå³å¯å…³è”åˆ°é›†ç¾¤</p>
<p>4ï¼‰åœ¨ç™½åå•ä¸­å¢åŠ æ–°æœå½¹çš„æœåŠ¡å™¨</p>
<h3 id="æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡"><a href="#æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡" class="headerlink" title="æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡"></a><strong>æœåŠ¡å™¨é—´æ•°æ®å‡è¡¡</strong></h3><p>1ï¼‰ä¼ä¸šç»éªŒï¼š </p>
<p>åœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œå¦‚æœç»å¸¸åœ¨ hadoop102 å’Œ hadoop104 ä¸Šæäº¤ä»»åŠ¡ï¼Œä¸”å‰¯æœ¬æ•°ä¸º 2ï¼Œç”±äºæ•°æ®æœ¬åœ°æ€§åŸåˆ™ï¼Œå°±ä¼šå¯¼è‡´ hadoop102 å’Œ hadoop104 æ•°æ®è¿‡å¤šï¼Œhadoop103 å­˜å‚¨çš„æ•°æ®é‡å°ã€‚å¦ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æ–°æœå½¹çš„æœåŠ¡å™¨æ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œéœ€è¦æ‰§è¡Œé›†ç¾¤å‡è¡¡å‘½ä»¤ã€‚ </p>
<p>2ï¼‰å¼€å¯æ•°æ®å‡è¡¡å‘½ä»¤ï¼š </p>
<p><code>[atguigu@hadoop105 hadoop-3.1.3]$ sbin/start-balancer.sh - threshold 10</code> </p>
<p>å¯¹äºå‚æ•° 10ï¼Œä»£è¡¨çš„æ˜¯é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡ç›¸å·®ä¸è¶…è¿‡ 10%ï¼Œå¯æ ¹æ®å® </p>
<p>é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚</p>
<p>3ï¼‰åœæ­¢æ•°æ®å‡è¡¡å‘½ä»¤ï¼š </p>
<p><code>[atguigu@hadoop105 hadoop-3.1.3]$ sbin/stop-balancer.sh</code> </p>
<p>æ³¨æ„ï¼šç”±äº HDFS éœ€è¦å¯åŠ¨å•ç‹¬çš„ Rebalance Server æ¥æ‰§è¡Œ Rebalance æ“ä½œï¼Œæ‰€ä»¥å°½é‡ </p>
<p>ä¸è¦åœ¨ NameNode ä¸Šæ‰§è¡Œ start-balancer.shï¼Œè€Œæ˜¯æ‰¾ä¸€å°æ¯”è¾ƒç©ºé—²çš„æœºå™¨ã€‚</p>
<h3 id="é»‘åå•é€€å½¹æœåŠ¡å™¨"><a href="#é»‘åå•é€€å½¹æœåŠ¡å™¨" class="headerlink" title="é»‘åå•é€€å½¹æœåŠ¡å™¨"></a><strong>é»‘åå•é€€å½¹æœåŠ¡å™¨</strong></h3><p>é»‘åå•ï¼šè¡¨ç¤ºåœ¨é»‘åå•çš„ä¸»æœº IP åœ°å€ä¸å¯ä»¥ï¼Œç”¨æ¥å­˜å‚¨æ•°æ®ã€‚ </p>
<p>ä¼ä¸šä¸­ï¼šé…ç½®é»‘åå•ï¼Œç”¨æ¥é€€å½¹æœåŠ¡å™¨ã€‚ </p>
<p>é»‘åå•é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š </p>
<p>1ï¼‰ç¼–è¾‘&#x2F;opt&#x2F;module&#x2F;hadoop-3.1.3&#x2F;etc&#x2F;hadoop ç›®å½•ä¸‹çš„ blacklist æ–‡ä»¶</p>
<p>â€‹    æ·»åŠ å¦‚ä¸‹ä¸»æœºåç§°ï¼ˆè¦é€€å½¹çš„èŠ‚ç‚¹ï¼‰    </p>
<p>2ï¼‰åˆ†å‘é…ç½®æ–‡ä»¶ blacklistï¼Œhdfs-site.xml</p>
<p>3ï¼‰ç¬¬ä¸€æ¬¡æ·»åŠ é»‘åå•å¿…é¡»é‡å¯é›†ç¾¤ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œåªéœ€è¦åˆ·æ–° NameNode èŠ‚ç‚¹å³å¯</p>
<p>4ï¼‰æ£€æŸ¥ Web æµè§ˆå™¨ï¼Œé€€å½¹èŠ‚ç‚¹çš„çŠ¶æ€ä¸º decommission in progressï¼ˆé€€å½¹ä¸­ï¼‰ï¼Œè¯´æ˜æ•°æ® </p>
<p>èŠ‚ç‚¹æ­£åœ¨å¤åˆ¶å—åˆ°å…¶ä»–èŠ‚ç‚¹ </p>
<img src="/2022/03/06/Hadoop%EF%BC%88%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98%E6%89%8B%E5%86%8C%EF%BC%89/1646553722796.png" class="" width="1646553722796">

<p>5<strong>ï¼‰ç­‰å¾…é€€å½¹èŠ‚ç‚¹çŠ¶æ€ä¸º</strong> decommissioned<strong>ï¼ˆæ‰€æœ‰å—å·²ç»å¤åˆ¶å®Œæˆï¼‰ï¼Œåœæ­¢è¯¥èŠ‚ç‚¹åŠèŠ‚ç‚¹èµ„æº</strong> </p>
<p>ç®¡ç†å™¨ã€‚æ³¨æ„ï¼šå¦‚æœå‰¯æœ¬æ•°æ˜¯ 3<strong>ï¼Œæœå½¹çš„èŠ‚ç‚¹å°äºç­‰äº</strong> 3<strong>ï¼Œæ˜¯ä¸èƒ½é€€å½¹æˆåŠŸçš„ï¼Œéœ€è¦ä¿®æ”¹</strong> </p>
<p>å‰¯æœ¬æ•°åæ‰èƒ½é€€å½¹</p>
<img src="/2022/03/06/Hadoop%EF%BC%88%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98%E6%89%8B%E5%86%8C%EF%BC%89/1646553737485.png" class="" width="1646553737485">

<p>6ï¼‰å¦‚æœæ•°æ®ä¸å‡è¡¡ï¼Œå¯ä»¥ç”¨å‘½ä»¤å®ç°é›†ç¾¤çš„å†å¹³è¡¡</p>
<h2 id="HDFSâ€”å­˜å‚¨ä¼˜åŒ–"><a href="#HDFSâ€”å­˜å‚¨ä¼˜åŒ–" class="headerlink" title="HDFSâ€”å­˜å‚¨ä¼˜åŒ–"></a>HDFSâ€”å­˜å‚¨ä¼˜åŒ–</h2><h3 id="çº åˆ ç åŸç†"><a href="#çº åˆ ç åŸç†" class="headerlink" title="çº åˆ ç åŸç†"></a><strong>çº åˆ ç åŸç†</strong></h3><p>â€‹    HDFS é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ–‡ä»¶æœ‰ 3 ä¸ªå‰¯æœ¬ï¼Œè¿™æ ·æé«˜äº†æ•°æ®çš„å¯é æ€§ï¼Œä½†ä¹Ÿå¸¦æ¥äº† 2 å€çš„å†—ä½™å¼€é”€ã€‚Hadoop3.x å¼•å…¥äº†çº åˆ ç ï¼Œé‡‡ç”¨è®¡ç®—çš„æ–¹å¼ï¼Œå¯ä»¥èŠ‚çœçº¦ 50ï¼…å·¦å³çš„å­˜å‚¨ç©ºé—´</p>
<img src="/2022/03/06/Hadoop%EF%BC%88%E7%94%9F%E4%BA%A7%E8%B0%83%E4%BC%98%E6%89%8B%E5%86%8C%EF%BC%89/1646553806181.png" class="" width="1646553806181">

]]></content>
      <categories>
        <category>Hadoop</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaç±»</title>
    <url>/2022/03/06/java%E7%B1%BB/</url>
    <content><![CDATA[<h3 id="Systemç±»"><a href="#Systemç±»" class="headerlink" title="Systemç±»"></a>Systemç±»</h3><p><strong>èŒƒä¾‹</strong>:åœ¨å¼€å‘ä¸­ç»Ÿè®¡è€—æ—¶</p>
<p><code>public static long currentTimeMillis();</code></p>
<h3 id="Clearnç±»"><a href="#Clearnç±»" class="headerlink" title="Clearnç±»"></a>Clearnç±»</h3><p>1.9ç‰ˆæœ¬ä¹‹åæä¾›çš„ä¸€ä¸ªå¯¹è±¡æ¸…ç†çš„ç±»ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯finialize()æ–¹æ³•çš„æ›¿ä»£ã€‚</p>
<h3 id="å¤§æ•°å­—ç±»å¤„ç†"><a href="#å¤§æ•°å­—ç±»å¤„ç†" class="headerlink" title="å¤§æ•°å­—ç±»å¤„ç†"></a>å¤§æ•°å­—ç±»å¤„ç†</h3><p><strong>è¿›è¡Œè¶…è¿‡äº†doubleèŒƒå›´ç±»å‹çš„æ•°å­—å¤„ç†</strong>ã€‚ä¸¤ä¸ªå¤§æ•°å­—æ“ä½œç±» BigInteger ä¸ BigDecimalç±»</p>
<img src="/2022/03/06/java%E7%B1%BB/1645946509291.png" class="" width="1645946509291">

<h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><table>
<thead>
<tr>
<th>public boolean matches(String regex)</th>
<th>æ™®é€š</th>
<th>å°†æŒ‡å®šå­—ç¬¦ä¸²è¿›è¡Œæ­£åˆ™åˆ¤æ–­</th>
</tr>
</thead>
<tbody><tr>
<td>public String replaceAll(String regex,String replacement)</td>
<td>æ™®é€š</td>
<td>æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢å…¨éƒ¨</td>
</tr>
<tr>
<td>public String replaceFirst(String regex,String replacement)</td>
<td>æ™®é€š</td>
<td>æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼æ›¿é¦–ä¸ª</td>
</tr>
<tr>
<td>public String[] split(String regex)</td>
<td>æ™®é€š</td>
<td>æ­£åˆ™æ‹†åˆ†</td>
</tr>
<tr>
<td>public String[] split(String regexï¼Œint limit)</td>
<td>æ™®é€š</td>
<td>æ­£åˆ™æ‹†åˆ†</td>
</tr>
</tbody></table>
<h3 id="Comparable"><a href="#Comparable" class="headerlink" title="Comparable"></a>Comparable</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Comparable</span>&lt;T&gt;&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å®ç°å¯¹è±¡çš„æ¯”è¾ƒå¤„ç†æ“ä½œ</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> o è¦æ¯”è¾ƒçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> å½“å‰æ•°æ®æ¯”ä¼ å…¥çš„å¯¹è±¡å°è¿”å›è´Ÿæ•°ï¼Œå¦‚æœå¤§äºè¿”å›æ•´æ•°ï¼Œå¦‚æœç­‰äºè¿”å›0</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(T o)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  æ’åºé‡Œé¢åªéœ€è¦ä¸€ä¸ªcompareTo()æ–¹æ³•è¿›è¡Œæ’åºè§„åˆ™çš„å®šä¹‰ï¼Œè€Œåæ•´ä¸ªJavaç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ä¸ºå…¶å®ç°æ’åºå¤„ç†äº†ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaAPIDemmo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ParseException  &#123;</span><br><span class="line">      Person data[] = <span class="keyword">new</span> <span class="title class_">Person</span>[] &#123;</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å°å¼ºA&quot;</span>, <span class="number">80</span>),</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å°å¼ºB&quot;</span>, <span class="number">100</span>),</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;å°å¼ºC&quot;</span>, <span class="number">50</span>)&#125;;</span><br><span class="line">          Arrays.sort(data);</span><br><span class="line">          System.out.println(Arrays.toString(data));</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Person&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name,<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Person per)</span> &#123;</span><br><span class="line">      <span class="comment">/*  if(this.age &lt; per.age)&#123;</span></span><br><span class="line"><span class="comment">            return -1;</span></span><br><span class="line"><span class="comment">        &#125;else if(this.age &gt; per.age)&#123;</span></span><br><span class="line"><span class="comment">            retrun 1;</span></span><br><span class="line"><span class="comment">        &#125;else&#123;</span></span><br><span class="line"><span class="comment">            return 0;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age - per.age; <span class="comment">//å‡åº</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ã€Personç±»å¯¹è±¡ã€‘å§“åï¼š&quot;</span>+<span class="built_in">this</span>.name+<span class="string">&quot;ã€å¹´é¾„ï¼š&quot;</span>+<span class="built_in">this</span>.age+<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[ã€Personç±»å¯¹è±¡ã€‘å§“åï¼šå°å¼ºCã€å¹´é¾„ï¼š50</span></span><br><span class="line"><span class="comment">, ã€Personç±»å¯¹è±¡ã€‘å§“åï¼šå°å¼ºAã€å¹´é¾„ï¼š80</span></span><br><span class="line"><span class="comment">, ã€Personç±»å¯¹è±¡ã€‘å§“åï¼šå°å¼ºBã€å¹´é¾„ï¼š100</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="Fileç±»"><a href="#Fileç±»" class="headerlink" title="Fileç±»"></a>Fileç±»</h3><p><strong>åœ¨æ–‡ä»¶åˆ›å»ºå‰è¦ç¡®ä¿å…¶çˆ¶è·¯å¾„å­˜åœ¨</strong>,çˆ¶è·¯å¾„ä¸å­˜åœ¨å¯ä»¥ç”¨.mkdirs()æ¥åˆ›å»ºçˆ¶ç›®å½•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!file.getParentFile().exists()) &#123;<span class="comment">//çˆ¶è·¯å¾„ä¸å­˜åœ¨</span></span><br><span class="line">	file.getParentFile( ).mkdirs() ; /åˆ›å»ºçˆ¶è·¯å¾„</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿ç•™ä¸¤ä½å°æ•°</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MathUtil</span>()&#123;</span><br><span class="line">    pribate <span class="title function_">MathUtil</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">round</span><span class="params">(<span class="type">double</span> num ,<span class="type">int</span> scale)</span>&#123;<span class="comment">//numæ˜¯è¦ä¿ç•™çš„æ•°å­—ï¼Œscaleæ˜¯ä¿ç•™å‡ ä½å°æ•°</span></span><br><span class="line">        retrun Math.round(Math.pow(<span class="number">10</span>,scale) * num) / Math.pow(<span class="number">10</span>,scale);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å­—èŠ‚æµå’Œå­—ç¬¦æµ"><a href="#å­—èŠ‚æµå’Œå­—ç¬¦æµ" class="headerlink" title="å­—èŠ‚æµå’Œå­—ç¬¦æµ"></a>å­—èŠ‚æµå’Œå­—ç¬¦æµ</h3><p>å¯¹äºæœåŠ¡å™¨æˆ–è€…æ˜¯å®¢æˆ·ç«¯è€Œè¨€å®è´¨ä¸Šä¼ é€’çš„å°±æ˜¯ä¸€ç§æ•°æ®æµçš„å¤„ç†å½¢å¼ï¼Œè€Œæ‰€è°“çš„æ•°æ®æµæŒ‡çš„å°±æ˜¯å­—èŠ‚æ•°æ®ã€‚è€Œå¯¹äºæµçš„å¤„ç†å½¢å¼åœ¨java.ioåŒ…é‡Œé¢æä¾›æœ‰ä¸¤ç±»æ”¯æŒï¼š</p>
<ul>
<li>å­—èŠ‚å¤„ç†æµï¼šOutputStream(è¾“å‡ºå­—èŠ‚æµ)ã€InputStream(è¾“å…¥å­—èŠ‚æµ)ï¼›</li>
<li>å­—ç¬¦å¤„ç†æµï¼šWriter(è¾“å‡ºå­—ç¬¦æµ)ã€Reader(è¾“å…¥å­—ç¬¦æµ)ã€‚</li>
</ul>
<h3 id="1-å­—èŠ‚è¾“å‡ºæµï¼šOutputStream"><a href="#1-å­—èŠ‚è¾“å‡ºæµï¼šOutputStream" class="headerlink" title="1.å­—èŠ‚è¾“å‡ºæµï¼šOutputStream"></a>1.å­—èŠ‚è¾“å‡ºæµï¼šOutputStream</h3><p>å­—èŠ‚çš„æ•°æ®æ˜¯ä»¥byteç±»å‹ä¸ºä¸»å®ç°çš„æ“ä½œï¼Œåœ¨è¿›è¡Œå­—èŠ‚å†…å®¹è¾“å‡ºçš„æ—¶å€™å¯ä»¥ä½¿ç”¨OutputStreamå®ç°ï¼Œè¿™ä¸ªç±»çš„åŸºæœ¬å®šä¹‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">OutputStream</span> <span class="keyword">extends</span> <span class="title class_">Object</span> <span class="keyword">implements</span> <span class="title class_">Closeable</span>,FlushableCopy to clipboardErrorCopied</span><br></pre></td></tr></table></figure>

<p><strong>OutputStreamç±»å®šä¹‰çš„æ˜¯ä¸€ä¸ªå…¬å…±çš„è¾“å‡ºæ“ä½œæ ‡å‡†ï¼Œè€Œåœ¨è¿™ä¸ªæ ‡å‡†é‡Œé¢ä¸€å…±å®šä¹‰æœ‰ï¼š</strong></p>
<table>
<thead>
<tr>
<th>No.</th>
<th>æ–¹æ³•åç§°</th>
<th>ç±»å‹</th>
<th>ç‰¹æ€§</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>public abstract void write(int b)throws IOException</td>
<td>æ™®é€š</td>
<td>è¾“å‡ºå•ä¸ªå­—èŠ‚æ•°æ®</td>
</tr>
<tr>
<td>02</td>
<td>public void write(byte[] b)throws IOException</td>
<td>æ™®é€š</td>
<td>è¾“å‡ºä¸€ç»„å­—èŠ‚æ•°æ®</td>
</tr>
<tr>
<td><strong>03</strong></td>
<td><strong>public void write(byte[] b,int off,int len)throws IOException</strong></td>
<td><strong>æ™®é€š</strong></td>
<td><strong>è¾“å‡ºéƒ¨åˆ†å­—èŠ‚æ•°æ®</strong></td>
</tr>
</tbody></table>
<h3 id="2-å­—èŠ‚è¾“å…¥æµï¼šInputStream"><a href="#2-å­—èŠ‚è¾“å…¥æµï¼šInputStream" class="headerlink" title="2.å­—èŠ‚è¾“å…¥æµï¼šInputStream"></a>2.å­—èŠ‚è¾“å…¥æµï¼šInputStream</h3><p><a href="https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/io/InputStream.html">InputStreamç±»</a>ä¸»è¦å®ç°çš„å°±æ˜¯å­—èŠ‚æ•°æ®è¯»å–ï¼Œè¯¥ç±»å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">InputStream</span> <span class="keyword">extends</span> <span class="title class_">Object</span> <span class="keyword">implements</span> <span class="title class_">CloseableCopy</span> to clipboardErrorCopied</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨InputStreamç±»é‡Œé¢å®šä¹‰æœ‰å¦‚ä¸‹å‡ ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼š</strong></p>
<table>
<thead>
<tr>
<th>No.</th>
<th>æ–¹æ³•åç§°</th>
<th>ç±»å‹</th>
<th>ç‰¹æ€§</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>public abstract int read() throws IOException</td>
<td>æ™®é€š</td>
<td>è¯»å–å•ä¸ªå­—èŠ‚æ•°æ®ï¼Œå¦‚æœç°åœ¨å·²ç»è¯»å–åˆ°åº•äº†ï¼Œè¿”å›-1</td>
</tr>
<tr>
<td><strong>02</strong></td>
<td><strong>public int read(byte[] b) throws IOException</strong></td>
<td><strong>æ™®é€š</strong></td>
<td><strong>è¯»å–ä¸€ç»„å­—èŠ‚æ•°æ®</strong></td>
</tr>
<tr>
<td>03</td>
<td>public int read(byte[] b, int off, int len) throws IOException</td>
<td>æ™®é€š</td>
<td>è¯»å–ä¸€ç»„å­—èŠ‚æ•°æ®(åªå æ•°ç»„çš„éƒ¨åˆ†)Â·</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaAPIDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:&quot;</span>+File.separator+<span class="string">&quot;hello&quot;</span>+File.separator+<span class="string">&quot;mldn.txt&quot;</span>);</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">        <span class="type">byte</span> data [] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>]; <span class="comment">//å¼€è¾Ÿä¸€ä¸ªç¼“å†²åŒºè¯»å–æ•°æ®</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> input.read(data); <span class="comment">//è¯»å–æ•°æ®ï¼Œæ•°æ®å…¨éƒ¨ä¿å­˜åœ¨å­—èŠ‚æ•°ç»„ä¹‹ä¸­ï¼Œè¿”å›è¯»å–ä¸ªæ•°</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ã€&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span>(data,<span class="number">0</span>,len)+<span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">        input.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Copy to clipboardErrorCopied</span><br></pre></td></tr></table></figure>

<h3 id="3-å­—ç¬¦è¾“å‡ºæµï¼šWriter"><a href="#3-å­—ç¬¦è¾“å‡ºæµï¼šWriter" class="headerlink" title="3.å­—ç¬¦è¾“å‡ºæµï¼šWriter"></a>3.å­—ç¬¦è¾“å‡ºæµï¼šWriter</h3><ul>
<li>è¾“å‡ºå­—ç¬¦æ•°ç»„ï¼špublic void write(char[] cbuf) throws IOExceptionï¼›</li>
<li>è¾“å‡ºå­—ç¬¦ä¸²ï¼špublic void write(String str) throws [IOException]ï¼›</li>
</ul>
<h3 id="4-å­—ç¬¦è¾“å…¥æµï¼šReader"><a href="#4-å­—ç¬¦è¾“å…¥æµï¼šReader" class="headerlink" title="4.å­—ç¬¦è¾“å…¥æµï¼šReader"></a>4.å­—ç¬¦è¾“å…¥æµï¼šReader</h3><p>å­—ç¬¦æµè¯»å–çš„æ—¶å€™åªèƒ½å¤ŸæŒ‰ç…§æ•°ç»„çš„å½¢å¼æ¥å®ç°å¤„ç†æ“ä½œã€‚</p>
<ul>
<li>æ¥å—æ•°æ®ï¼špublic int read(char[] cbuf) throws IOException;</li>
</ul>
<h3 id="5-å­—ç¬¦æµå’Œå­—èŠ‚æµçš„åŒºåˆ«"><a href="#5-å­—ç¬¦æµå’Œå­—èŠ‚æµçš„åŒºåˆ«" class="headerlink" title="5.å­—ç¬¦æµå’Œå­—èŠ‚æµçš„åŒºåˆ«"></a>5.å­—ç¬¦æµå’Œå­—èŠ‚æµçš„åŒºåˆ«</h3><p>åœ¨ä½¿ç”¨OutputStreamç±»è¾“å‡ºçš„æ—¶å€™å¦‚æœç°åœ¨æ²¡æœ‰ä½¿ç”¨close()æ–¹æ³•å…³é—­è¾“å‡ºæµå‘ç°å†…å®¹ä¾ç„¶å¯ä»¥æ­£å¸¸çš„è¾“å‡ºã€‚ä½†å¦‚æœåœ¨ä½¿ç”¨Writerè¾“å‡ºçš„æ—¶å€™å¦‚æœç°åœ¨æ²¡æœ‰ä½¿ç”¨close()æ–¹æ³•å…³é—­è¾“å‡ºæµï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å†…å®¹å°†æ— æ³•è¿›è¡Œè¾“å‡ºï¼Œå› ä¸ºWriterä½¿ç”¨åˆ°äº†ç¼“å†²åŒºã€‚å½“ä½¿ç”¨close()æ–¹æ³•çš„æ—¶å€™å°†ä¼šå‡ºç°å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒºçš„æƒ…å†µï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¼šå°†å†…å®¹è¿›è¡Œè¾“å‡ºï¼Œå¦‚æœæ²¡æœ‰å…³é—­ï¼Œé‚£ä¹ˆå°†æ— æ³•è¿›è¡Œè¾“å‡ºæ“ä½œï¼Œæ‰€ä»¥æ­¤æ—¶å¦‚æœåœ¨ä¸å…³é—­çš„æƒ…å†µä¸‹è¦æƒ³å°†å…¨éƒ¨çš„å†…å®¹è¾“å‡ºå¯ä»¥ä½¿ç”¨flush()æ–¹æ³•å¼ºåˆ¶æ¸…ç©ºã€‚</p>
<p><strong>å­—èŠ‚æµåœ¨è¿›è¡Œå¤„ç†çš„æ—¶å€™å¹¶ä¸ä¼šä½¿ç”¨åˆ°ç¼“å†²åŒºï¼Œè€Œå­—ç¬¦æµä¼šä½¿ç”¨åˆ°ç¼“å†²åŒºã€‚å¦å¤–é‚£ä¸ªç¼“å†²åŒºçš„å­—ç¬¦æµæ›´åŠ é€‚åˆäºä¸­æ–‡æ•°æ®çš„å¤„ç†ã€‚</strong></p>
<p>ç»“è®ºï¼šåªè¦æ˜¯çº¯æ–‡æœ¬æ•°æ®ä¼˜å…ˆä½¿ç”¨å­—ç¬¦æµï¼Œé™¤æ­¤ä¹‹å¤–éƒ½ä½¿ç”¨å­—èŠ‚æµã€‚</p>
<h3 id="Javaåºåˆ—åŒ–"><a href="#Javaåºåˆ—åŒ–" class="headerlink" title="Javaåºåˆ—åŒ–"></a>Javaåºåˆ—åŒ–</h3><p><strong>ç”¨ioåŒ…ä¸­çš„ Serializableæ¥å£å°±å¯å®ç°åºåˆ—åŒ–</strong></p>
<h3 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h3><table>
<thead>
<tr>
<th>å½“ä½¿ç”¨æ— å‚æ–¹æ³•æ„é€ æ—¶ä¼šæœ‰ä¸€ä¸ªloadFactorå±æ€§ï¼Œå¹¶ä¸”é»˜è®¤ä¸º0.75</th>
</tr>
</thead>
<tbody><tr>
<td>ä½¿ç”¨putï¼ˆï¼‰æ–¹æ³•ä¿å­˜æ—¶ä¼šè°ƒç”¨putVal()æ–¹æ³•ï¼Œè€Œåœ¨putValæ–¹æ³•é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªæ•°æ®çš„ä¿å­˜ï¼Œè°ƒç”¨resizeï¼ˆï¼‰æ–¹æ³•è¿›è¡Œå®¹é‡çš„æ‰©å……</td>
</tr>
</tbody></table>
<p><strong>æ˜¯å¦‚ä½•ç”¨put()æ‰©å……çš„ï¼Ÿ</strong></p>
<p>a.åœ¨ HashMap_ç±»é‡Œé¢æä¾›æœ‰ä¸€ä¸ªâ€œDEFAULT_ INITIAL_CAPACITYâ€å¸¸é‡ï¼Œä½œä¸º16ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤å¯ä»¥ä¿å­˜çš„æœ€å¤§å†…å®¹æ˜¯16;</p>
<p>b.å½“ä¿å­˜çš„å†…å®¹çš„å®¹é‡è¶…è¿‡äº†ä¸ä¸ªé˜ˆå€¼â€œDEFAULT LOAD FACTOR &#x3D; 0.75fâ€ï¼Œç›¸å½“ä¸â€œå®¹é‡ * é˜ˆå€¼ &#x3D; 12â€œ ä¿å­˜12ä¸ªå…ƒç´ çš„æ—¶å€™å°±ä¼šè¿›è¡Œå®¹é‡çš„æ‰©å……;</p>
<p>c.åœ¨é‡‡ç”¨æ‰©å……çš„æ—¶å€™æ¯æ¬¡æ‰©å……2å€çš„å®¹é‡   æºä»£ç &lt;&lt;1 å‘å·¦ç§»ä¸€</p>
<p><strong>è¯·è§£é‡Šå·¥ä½œåŸç†</strong></p>
<p>a.å­˜å‚¨ä¾ç„¶æ˜¯ç”¨äº†Nodeç±»å®Œæˆçš„    ï¼ˆé“¾è¡¨ï¼ˆæ—¶é—´å¤æ‚åº¦O(nï¼‰ã€äºŒå‰æ ‘ï¼ˆæ—¶é—´å¤æ‚åº¦O(lognï¼‰ï¼‰ã€‚</p>
<p>b.ä»1.8èµ·è¦é€‚åº”å¤§æ•°æ®æ—¶ä»£ï¼Œæ‰€ä»¥å­˜å‚¨å‘ç”Ÿäº†å˜åŒ–ï¼Œæä¾›äº†ä¸€ä¸ªå¸¸é‡<code>TREEIFY THRESHOLD = 8</code>ï¼Œå¦‚æœé˜ˆå€¼æ²¡æœ‰è¶…è¿‡8é‚£å°±ä¼šæŒ‰ç…§é“¾è¡¨çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¶…è¿‡8åˆ™ä¼šé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘</p>
<p>é€šè¿‡HashMapå®ä¾‹åŒ–çš„Mapæ¥å£å¯ä»¥é’ˆå¯¹ä¸keyæˆ–value<strong>ä¿å­˜nullçš„æ•°æ®</strong>ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‘ç°å³ä¾¿ä¿å­˜æ•°æ®çš„<strong>keyé‡å¤</strong>ï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šå‡ºç°é”™è¯¯ï¼Œè€Œæ˜¯å‡ºç°<strong>å†…å®¹çš„æ›¿æ¢</strong>ã€‚</p>
<p><strong>é¢è¯•é¢˜ï¼šåœ¨è¿›è¡ŒHashMapçš„put()æ“ä½œçš„æ—¶å€™ï¼Œå¦‚ä½•å®ç°å®¹é‡çš„æ‰©å……ï¼Ÿ</strong></p>
<ul>
<li>åœ¨HashMapç±»é‡Œé¢æä¾›æœ‰ä¸€ä¸ªâ€œDEFAULT_INITIAL_CAPACITYâ€å¸¸é‡ï¼Œä½œä¸ºåˆå§‹åŒ–çš„å®¹é‡é…ç½®ï¼Œä½œä¸ºåˆå§‹åŒ–å¤§å°ä¸º16ä¸ªå…ƒç´ ã€‚</li>
<li>å½“æˆ‘ä»¬ä¿å­˜çš„å®¹é‡è¶…è¿‡äº†ä¸€ä¸ªé˜ˆå€¼(DEFAULT_LOAD_FACTOP&#x3D;0.75f)ï¼Œç›¸å½“äºå®¹é‡*é˜ˆå€¼&#x3D;12ï¼Œä¿å­˜12ä¸ªå…ƒç´ çš„æ—¶å€™å®¹é‡ä¼šæ‰©å……ã€‚</li>
<li>åœ¨è¿›è¡Œæ‰©å……çš„æ—¶å€™HashMapé‡‡ç”¨çš„æ˜¯æˆå€æ‰©å……æ¨¡å¼ã€‚</li>
</ul>
<p><strong>HashMapæ˜¯ä½¿ç”¨äº†å“ªäº›æ–¹æ³•æ¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªï¼Ÿ</strong></p>
<ol>
<li>ä½¿ç”¨ é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥é“¾æ¥æ‹¥æœ‰ç›¸åŒhashå€¼çš„æ•°æ®ï¼›</li>
<li>ä½¿ç”¨ 2æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆhashå‡½æ•°ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡ï¼›</li>
<li>å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ï¼›</li>
</ol>
<p><strong>HashMapåœ¨JDK1.7å’ŒJDK1.8ä¸­æœ‰å“ªäº›ä¸åŒ</strong></p>
<table>
<thead>
<tr>
<th>ä¸åŒ</th>
<th>JDK 1.7</th>
<th>JDK 1.8</th>
</tr>
</thead>
<tbody><tr>
<td>å­˜å‚¨ç»“æ„</td>
<td>æ•°ç»„ + é“¾è¡¨</td>
<td>æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</td>
</tr>
<tr>
<td>åˆå§‹åŒ–æ–¹å¼</td>
<td>å•ç‹¬å‡½æ•°ï¼š<code>inflateTable()</code></td>
<td>ç›´æ¥é›†æˆåˆ°äº†æ‰©å®¹å‡½æ•°<code>resize()</code>ä¸­</td>
</tr>
<tr>
<td>hashå€¼è®¡ç®—æ–¹å¼</td>
<td>æ‰°åŠ¨å¤„ç† &#x3D; 9æ¬¡æ‰°åŠ¨ &#x3D; 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—</td>
<td>æ‰°åŠ¨å¤„ç† &#x3D; 2æ¬¡æ‰°åŠ¨ &#x3D; 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—</td>
</tr>
<tr>
<td>å­˜æ”¾æ•°æ®çš„è§„åˆ™</td>
<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›å†²çªæ—¶ï¼Œå­˜æ”¾é“¾è¡¨</td>
<td>æ— å†²çªæ—¶ï¼Œå­˜æ”¾æ•°ç»„ï¼›å†²çª &amp; é“¾è¡¨é•¿åº¦ &lt;&#x3D; 8ï¼šå­˜æ”¾å•é“¾è¡¨ï¼›å†²çª &amp; é“¾è¡¨é•¿åº¦ &gt; 8ï¼šæ ‘åŒ–å¹¶å­˜æ”¾çº¢é»‘æ ‘</td>
</tr>
<tr>
<td>æ’å…¥æ•°æ®æ–¹å¼</td>
<td>å¤´æ’æ³•ï¼ˆå…ˆè®²åŸä½ç½®çš„æ•°æ®ç§»åˆ°å1ä½ï¼Œå†æ’å…¥æ•°æ®åˆ°è¯¥ä½ç½®ï¼‰</td>
<td>å°¾æ’æ³•ï¼ˆç›´æ¥æ’å…¥åˆ°é“¾è¡¨å°¾éƒ¨&#x2F;çº¢é»‘æ ‘ï¼‰</td>
</tr>
<tr>
<td>æ‰©å®¹åå­˜å‚¨ä½ç½®çš„è®¡ç®—æ–¹å¼</td>
<td>å…¨éƒ¨æŒ‰ç…§åŸæ¥æ–¹æ³•è¿›è¡Œè®¡ç®—ï¼ˆå³hashCode -&gt;&gt; æ‰°åŠ¨å‡½æ•° -&gt;&gt; (h&amp;length-1)ï¼‰</td>
<td>æŒ‰ç…§æ‰©å®¹åçš„è§„å¾‹è®¡ç®—ï¼ˆå³æ‰©å®¹åçš„ä½ç½®&#x3D;åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡ï¼‰</td>
</tr>
</tbody></table>
<p><strong>ä¸ºä»€ä¹ˆJDK1.8è¦ç”¨å°¾æ’æ³•ï¼Ÿ</strong></p>
<p><strong>ä½¿ç”¨å¤´æ’</strong>ä¼šæ”¹å˜é“¾è¡¨çš„ä¸Šçš„é¡ºåºï¼Œä½†æ˜¯å¦‚æœ<strong>ä½¿ç”¨å°¾æ’</strong>ï¼Œåœ¨æ‰©å®¹æ—¶ä¼šä¿æŒé“¾è¡¨å…ƒç´ åŸæœ¬çš„é¡ºåºï¼Œå°±ä¸ä¼šå‡ºç°<strong>é“¾è¡¨æˆç¯</strong>çš„é—®é¢˜äº†ã€‚</p>
<p>é¢è¯•é¢˜ï¼šè¯·è§£é‡ŠHashMapä¸Hashtableçš„åŒºåˆ«ï¼š</p>
<ul>
<li>HashMapä¸­çš„æ–¹æ³•éƒ½å±äºå¼‚æ­¥æ“ä½œ(éçº¿ç¨‹å®‰å…¨),HashMapå…è®¸ä¿å­˜æœ‰nullæ•°æ®ï¼›</li>
<li>Hashtableä¸­çš„æ–¹æ³•éƒ½å±äºåŒæ­¥æ–¹æ³•(çº¿ç¨‹å®‰å…¨)ï¼ŒHashtableä¸å…è®¸ä¿å­˜nullï¼Œå¦åˆ™ä¼šå‡ºç°NullPointExceptionã€‚</li>
</ul>
<p><strong>ä½¿ç”¨Iteratorå®ç°Mapé›†åˆçš„è¾“å‡ºæ­¥éª¤ï¼š</strong></p>
<ul>
<li><p>åˆ©ç”¨Mapæ¥å£ä¸­æä¾›çš„entrySet()æ–¹æ³•å°†Mapé›†åˆè½¬ä¸ºSeté›†åˆï¼›</p>
</li>
<li><p>åˆ©ç”¨Setæ¥å£ä¸­çš„iterator()æ–¹æ³•å°†Seté›†åˆè½¬ä¸ºIteratoræ¥å£å®ä¾‹ï¼›</p>
</li>
<li><p>åˆ©ç”¨Iteratorè¿›è¡Œè¿­ä»£è¾“å‡ºè·å–æ¯ä¸€ç»„Map.Entryå¯¹è±¡ï¼Œéšåé€šè¿‡getKey()ä¸getValue()è·å–æ•°æ®</p>
<img src="/2022/03/06/java%E7%B1%BB/1646315474798.png" class="" width="1646315474798">

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map&lt;Double,String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">     map.put(<span class="number">1d</span>,<span class="string">&quot;aaa&quot;</span>);<span class="comment">//æ·»åŠ </span></span><br><span class="line">     map.put(<span class="number">2d</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">     map.put(<span class="number">3d</span>,<span class="string">&quot;ccc&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (Object f:map.entrySet())&#123;</span><br><span class="line">         System.out.println(f);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Javaç±»</tag>
      </tags>
  </entry>
  <entry>
    <title>Hadoop</title>
    <url>/2022/03/06/hadoop/</url>
    <content><![CDATA[<h3 id="Mapperã€Reducerï¼ŒDriveræ„é€ æ­¥éª¤"><a href="#Mapperã€Reducerï¼ŒDriveræ„é€ æ­¥éª¤" class="headerlink" title="Mapperã€Reducerï¼ŒDriveræ„é€ æ­¥éª¤"></a>Mapperã€Reducerï¼ŒDriveræ„é€ æ­¥éª¤</h3><h4 id="Mapperï¼š"><a href="#Mapperï¼š" class="headerlink" title="Mapperï¼š"></a>Mapperï¼š</h4><p>â€‹    1.extend Mapper&lt;k,v,k,v&gt;,æ³¨æ„å‡ºå…¥å’Œè¾“å‡ºkvçš„æ ¼å¼ï¼ˆ<font color='red'>ä¸javaä¸åŒæ³¨æ„åŒ…</font>ï¼‰  </p>
<p>â€‹    2.ç„¶åé‡å†™ mapæ–¹æ³•ï¼Œæ ¹æ®æºç å¯çŸ¥ é‡Œé¢çš„mapæ–¹æ³•æœ‰å‡ ä¸ªkvå°±è¿è¡Œå‡ æ¬¡æ‰€ä»¥è¦æŠŠä¸€äº›åˆ›å»ºç±»çš„ä¸œè¥¿æ”¾åœ¨æ–¹æ³•å¤–é¢ã€‚</p>
<p>â€‹    3.context.write(k,v);ï¼Œæäº¤æ—¶è¦æ³¨æ„kvçš„æ•°æ®ç±»å‹ã€‚</p>
<h4 id="Reducerï¼š"><a href="#Reducerï¼š" class="headerlink" title="Reducerï¼š"></a>Reducerï¼š</h4><p>â€‹    1.extend Reducer&lt;kv,v,k,v&gt;,æ³¨æ„å‡ºå…¥å’Œè¾“å‡ºkvçš„æ ¼å¼ï¼ˆä¸javaä¸åŒæ³¨æ„åŒ…ï¼‰  </p>
<p>â€‹    2.ç„¶åé‡å†™ reduceæ–¹æ³•ï¼Œæ ¹æ®æºç å¯çŸ¥ é‡Œé¢çš„reduceæ–¹æ³•ä¼šæ ¹æ®valueçš„ä¸ªæ•°æ¥è¿è¡Œå‡ æ¬¡æ‰€ä»¥è¦æŠŠä¸€äº›åˆ›å»ºç±»çš„ä¸œè¥¿æ”¾åœ¨æ–¹æ³•å¤–é¢ã€‚</p>
<p>â€‹    3.context.write(k,v);ï¼Œæäº¤æ—¶è¦æ³¨æ„kvçš„æ•°æ®ç±»å‹ã€‚</p>
<h4 id="Driverï¼š"><a href="#Driverï¼š" class="headerlink" title="Driverï¼š"></a>Driverï¼š</h4><p>â€‹    1.è·å–Jobå¯¹è±¡</p>
<p>â€‹    2.å…³è”Driverç±»</p>
<p>â€‹    3.å…³è”Mapperç±»ä¸å…³è”Reducerç±»</p>
<p>â€‹    4.è®¾ç½®Mapçš„KVç±»å‹</p>
<p>â€‹    5.è®¾ç½®æœ€ç»ˆè¾“å‡ºçš„KVç±»å‹</p>
<p>â€‹    6.è®¾ç½®ç¨‹åºçš„è¾“å…¥è¾“å‡ºæ–‡ä»¶è·¯å¾„</p>
<p>â€‹    7.æäº¤Job</p>
<p><strong>MapTaskå¹¶è¡Œåº¦å†³å®šæœºåˆ¶</strong></p>
<p><strong>æ•°æ®å—ï¼š</strong>Blockæ˜¯HDFSç‰©ç†ä¸ŠæŠŠæ•°æ®åˆ†æˆä¸€å—ä¸€å—ã€‚æ•°æ®å—æ˜¯HDFSå­˜å‚¨æ•°æ®å•ä½ã€‚</p>
<p><strong>æ•°æ®åˆ‡ç‰‡ï¼š</strong>æ•°æ®åˆ‡ç‰‡åªæ˜¯åœ¨é€»è¾‘ä¸Šå¯¹è¾“å…¥è¿›è¡Œåˆ†ç‰‡ï¼Œå¹¶ä¸ä¼šåœ¨ç£ç›˜ä¸Šå°†å…¶åˆ‡åˆ†æˆç‰‡è¿›è¡Œå­˜å‚¨ã€‚æ•°æ®åˆ‡ç‰‡æ˜¯MapReduceç¨‹åºè®¡ç®—è¾“å…¥æ•°æ®çš„å•ä½ï¼Œä¸€ä¸ªåˆ‡ç‰‡ä¼šå¯¹åº”å¯åŠ¨ä¸€ä¸ªMapTaskã€‚</p>
<img src="/2022/03/06/hadoop/1646563177298.png" class="" width="1646563177298">

<p>â€‹    å¦‚æœåˆ†ä¸º100Mçš„è¯ DataNode2è¿˜è¦ä» 1 ä¸­è·å– 28Mä¸è‡ªå·±çš„100Mè¿›è¡Œåˆå¹¶è¿ç®—ï¼Œä¸­é—´æœ‰ä¼ è¾“æ—¶é—´å’Œåˆå¹¶æ—¶é—´ï¼Œæ•ˆç‡ä½ï¼Œæ‰€ä»¥è¦æ ¹æ®å—çš„å¤§å°æ¥è®¾ç½®åˆ‡ç‰‡å¤§å°ã€‚</p>
<h3 id="Jobæäº¤æµç¨‹æºç è¯¦è§£"><a href="#Jobæäº¤æµç¨‹æºç è¯¦è§£" class="headerlink" title="Jobæäº¤æµç¨‹æºç è¯¦è§£"></a><strong>Jobæäº¤æµç¨‹æºç è¯¦è§£</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">waitForCompletion()</span><br><span class="line"></span><br><span class="line">submit();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// 1å»ºç«‹è¿æ¥</span><br><span class="line"></span><br><span class="line">â€‹	connect();	</span><br><span class="line"></span><br><span class="line">â€‹		// 1ï¼‰åˆ›å»ºæäº¤Jobçš„ä»£ç†</span><br><span class="line"></span><br><span class="line">â€‹		new Cluster(getConfiguration());</span><br><span class="line"></span><br><span class="line">â€‹			// ï¼ˆ1ï¼‰åˆ¤æ–­æ˜¯æœ¬åœ°è¿è¡Œç¯å¢ƒè¿˜æ˜¯yarné›†ç¾¤è¿è¡Œç¯å¢ƒ</span><br><span class="line"></span><br><span class="line">â€‹			initialize(jobTrackAddr, conf);   //è¿”å›0æ˜¯æœ¬åœ°  1æ˜¯yarn</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// 2 æäº¤job</span><br><span class="line"></span><br><span class="line">submitter.submitJobInternal(Job.this, cluster)</span><br><span class="line"></span><br><span class="line"> 	é¦–å…ˆæ£€å¯Ÿè¾“å‡ºè·¯å¾„æ˜¯å¦å­˜åœ¨ï¼ˆä¼šæŠ›å‡ºå¼‚å¸¸ 1.ä¸ºç©ºï¼ˆæ²¡æœ‰å¡«å†™è¾“å‡ºè·¯å¾„ï¼‰ï¼Œ2.è·¯å¾„å­˜åœ¨ï¼‰</span><br><span class="line"></span><br><span class="line">â€‹	// 1ï¼‰åˆ›å»ºç»™é›†ç¾¤æäº¤æ•°æ®çš„Stagè·¯å¾„ï¼ˆä¸´æ—¶ç¼“å­˜è·¯å¾„ï¼‰</span><br><span class="line"></span><br><span class="line">â€‹	Path jobStagingArea = JobSubmissionFiles.getStagingDir(cluster, conf);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">â€‹	// 2ï¼‰è·å–jobIdï¼ˆæ¯ä¸€ä¸ªjobéƒ½æœ‰ä¸€ä¸ªidï¼‰ ï¼Œå¹¶åˆ›å»ºJobè·¯å¾„  åœ¨ä¸Šä¸€æ­¥çš„Stagè·¯å¾„ååŠ ä¸ŠjobID</span><br><span class="line"></span><br><span class="line">â€‹	JobID jobId = submitClient.getNewJobID();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">â€‹	// 3ï¼‰æ‹·è´jaråŒ…åˆ°é›†ç¾¤</span><br><span class="line"></span><br><span class="line">	copyAndConfigureFiles(job, submitJobDir);	 //æœ¬åœ°æ¨¡å¼ä¸ä¼šæäº¤jar  é›†ç¾¤æ¨¡å¼ä¼šæäº¤</span><br><span class="line"></span><br><span class="line">	rUploader.uploadFiles(job, jobSubmitDir);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">â€‹	// 4ï¼‰è®¡ç®—åˆ‡ç‰‡ï¼Œç”Ÿæˆåˆ‡ç‰‡è§„åˆ’æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">â€‹		writeSplits(job, submitJobDir);</span><br><span class="line"></span><br><span class="line">â€‹		maps = writeNewSplits(job, jobSubmitDir);   //æ ¹æ®åˆ‡ç‰‡ä¿¡æ¯ç”Ÿäº§å‡ ä¸ªmapTask</span><br><span class="line"></span><br><span class="line">â€‹		input.getSplits(job);      //æŠŠåˆ‡ç‰‡ä¿¡æ¯ä¿å­˜åˆ° jobIDè·¯å¾„</span><br><span class="line">	æ ¹åŸºåˆ‡ç‰‡ä¸ªæ•°ç”Ÿæˆå‡ ä¸ªmap   å¹¶æŠŠåˆ‡ç‰‡ä¿¡æ¯ä»¥logæ–¹å¼è¾“å‡ºï¼Œåœ¨æ‰§è¡Œæ—¥å¿—ä¸­ä¹Ÿå¯ä»¥çœ‹è§</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">â€‹	// 5ï¼‰å‘Stagè·¯å¾„å†™XMLé…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">writeConf(conf, submitJobFile);    //ä»»ç„¶ä¿å­˜åˆ°JobIDä¸‹çš„è·¯å¾„ </span><br><span class="line"></span><br><span class="line">â€‹	conf.writeXml(out); </span><br><span class="line"></span><br><span class="line">â€‹	// 6ï¼‰æäº¤Job,è¿”å›æäº¤çŠ¶æ€</span><br><span class="line"></span><br><span class="line">status = submitClient.submitJob(jobId, submitJobDir.toString(), job.getCredentials());</span><br><span class="line">//æäº¤å®Œæ¯•åä¼šå°†åˆšæ‰ç”Ÿäº§çš„ç¼“å­˜æ–‡ä»¶åˆ é™¤	</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆæäº¤ä¿¡æ¯ä¸ºï¼š</p>
<img src="/2022/03/06/hadoop/1646528945437.png" class="" width="1646528945437">

<img src="/2022/03/06/hadoop/1646471050412.png" class="" width="1646471050412">

<img src="/2022/03/06/hadoop/1646563186420.png" class="" width="1646563186420">

<img src="/2022/03/06/hadoop/1646563193170.png" class="" width="1646563193170">

<p>minSize &#x3D; 1; maxSize &#x3D; longçš„æœ€å¤§å€¼    bolckSize &#x3D; 128m  ï¼ˆåœ¨æœ¬åœ°è¿è¡Œä¸º32mï¼‰</p>
<p><strong>TextInputFormat</strong></p>
<p>â€‹        TextInputFormatæ˜¯é»˜è®¤çš„FileInputFormatå®ç°ç±»ã€‚æŒ‰è¡Œè¯»å–æ¯æ¡è®°å½•ã€‚é”®æ˜¯å­˜å‚¨è¯¥è¡Œåœ¨æ•´ä¸ªæ–‡ä»¶ä¸­çš„èµ·å§‹å­—èŠ‚åç§»é‡ï¼Œ LongWritableç±»å‹ã€‚å€¼æ˜¯è¿™è¡Œçš„å†…å®¹ï¼Œä¸åŒ…æ‹¬ä»»ä½•è¡Œç»ˆæ­¢ç¬¦ï¼ˆæ¢è¡Œç¬¦å’Œå›è½¦ç¬¦ï¼‰ï¼ŒTextç±»å‹ã€‚</p>
<p><img src="/1646470491592.png" alt="1646470491592"></p>
<h3 id="CombineTextInputFormatåˆ‡ç‰‡æœºåˆ¶"><a href="#CombineTextInputFormatåˆ‡ç‰‡æœºåˆ¶" class="headerlink" title="CombineTextInputFormatåˆ‡ç‰‡æœºåˆ¶"></a><strong>CombineTextInputFormat</strong>åˆ‡ç‰‡æœºåˆ¶</h3><p>â€‹    CombineTextInputFormatç”¨äºå°æ–‡ä»¶è¿‡å¤šçš„åœºæ™¯ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªå°æ–‡ä»¶ä»é€»è¾‘ä¸Šè§„åˆ’åˆ°ä¸€ä¸ªåˆ‡ç‰‡ä¸­ï¼Œè¿™æ ·ï¼Œå¤šä¸ªå°æ–‡ä»¶å°±å¯ä»¥äº¤ç»™ä¸€ä¸ªMapTaskå¤„ç†ã€‚</p>
<p><strong>è™šæ‹Ÿå­˜å‚¨åˆ‡ç‰‡æœ€å¤§å€¼è®¾ç½®ï¼š</strong><font color='cornflowerblue'>CombineTextInputFormat.setMaxInputSplitSize(job, 4194304);&#x2F;&#x2F; 4m</font></p>
<p><font color='orange'>æ³¨æ„ï¼šè™šæ‹Ÿå­˜å‚¨åˆ‡ç‰‡æœ€å¤§å€¼è®¾ç½®æœ€å¥½æ ¹æ®å®é™…çš„å°æ–‡ä»¶å¤§å°æƒ…å†µæ¥è®¾ç½®å…·ä½“çš„å€¼ã€‚</font></p>
<p><strong>åˆ‡ç‰‡æœºåˆ¶ï¼š</strong></p>
<p>â€‹    ç”Ÿæˆåˆ‡ç‰‡è¿‡ç¨‹åŒ…æ‹¬ï¼šè™šæ‹Ÿå­˜å‚¨è¿‡ç¨‹å’Œåˆ‡ç‰‡è¿‡ç¨‹äºŒéƒ¨åˆ†ã€‚</p>
<img src="/2022/03/06/hadoop/1646563201262.png" class="" width="1646563201262">

<h4 id="è™šæ‹Ÿå­˜å‚¨è¿‡ç¨‹ï¼š"><a href="#è™šæ‹Ÿå­˜å‚¨è¿‡ç¨‹ï¼š" class="headerlink" title="è™šæ‹Ÿå­˜å‚¨è¿‡ç¨‹ï¼š"></a>è™šæ‹Ÿå­˜å‚¨è¿‡ç¨‹ï¼š</h4><p>â€‹    å°†è¾“å…¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¤§å°ï¼Œä¾æ¬¡å’Œè®¾ç½®çš„setMaxInputSplitSizeå€¼æ¯”è¾ƒï¼Œå¦‚æœä¸å¤§äºè®¾ç½®çš„æœ€å¤§å€¼ï¼Œé€»è¾‘ä¸Šåˆ’åˆ†ä¸€ä¸ªå—ã€‚å¦‚æœè¾“å…¥æ–‡ä»¶å¤§äºè®¾ç½®çš„æœ€å¤§å€¼ä¸”å¤§äºä¸¤å€ï¼Œé‚£ä¹ˆä»¥æœ€å¤§å€¼åˆ‡å‰²ä¸€å—ï¼›å½“å‰©ä½™æ•°æ®å¤§å°è¶…è¿‡è®¾ç½®çš„æœ€å¤§å€¼ä¸”ä¸å¤§äºæœ€å¤§å€¼2å€ï¼Œæ­¤æ—¶å°†æ–‡ä»¶å‡åˆ†æˆ2ä¸ªè™šæ‹Ÿå­˜å‚¨å—ï¼ˆé˜²æ­¢å‡ºç°å¤ªå°åˆ‡ç‰‡ï¼‰ã€‚</p>
<p>â€‹    ä¾‹å¦‚setMaxInputSplitSizeå€¼ä¸º4Mï¼Œè¾“å…¥æ–‡ä»¶å¤§å°ä¸º8.02Mï¼Œåˆ™å…ˆé€»è¾‘ä¸Šåˆ†æˆä¸€ä¸ª4Mã€‚å‰©ä½™çš„å¤§å°ä¸º4.02Mï¼Œå¦‚æœæŒ‰ç…§4Mé€»è¾‘åˆ’åˆ†ï¼Œå°±ä¼šå‡ºç°0.02Mçš„å°çš„è™šæ‹Ÿå­˜å‚¨æ–‡ä»¶ï¼Œæ‰€ä»¥å°†å‰©ä½™çš„4.02Mæ–‡ä»¶åˆ‡åˆ†æˆï¼ˆ2.01Må’Œ2.01Mï¼‰ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<p><strong>ä¾‹ï¼š</strong></p>
<p>â€‹    è¾“å…¥æ•°æ®ä¸º4ä¸ªå°æ–‡ä»¶ï¼Œåœ¨ä¸ç»è¿‡ä»»ä½•å¤„ç†è¿è¡Œæ—¶åˆ‡ç‰‡ä¸ªæ•°ä¸º4ä¸ªï¼Œå½“åœ¨Driverä¸­å¢åŠ <code>CombineTextInputFormat.setMaxInputSplitSize(job, 4194304); </code>æ—¶ï¼Œåˆ‡ç‰‡ä¸ªæ•°ä¸ºä¸º3ä¸ª</p>
<p>å½“å°†å¤§å°æ”¹ä¸º 20971520ï¼ˆ20mï¼‰æ—¶åˆ‡ç‰‡å„ä¸ªå˜ä¸º1ä¸ªã€‚åªäº§ç”Ÿä¸€ä¸ªMapTaskæé«˜äº†æ•ˆç‡ã€‚</p>
<h3 id="MapReduceå·¥ä½œæµç¨‹"><a href="#MapReduceå·¥ä½œæµç¨‹" class="headerlink" title="MapReduceå·¥ä½œæµç¨‹"></a>MapReduceå·¥ä½œæµç¨‹</h3><img src="/2022/03/06/hadoop/1646563207533.png" class="" width="1646563207533">

<img src="/2022/03/06/hadoop/1646563211839.png" class="" width="1646563211839">

<p>ä¸Šé¢çš„æµç¨‹æ˜¯æ•´ä¸ªMapReduceæœ€å…¨å·¥ä½œæµç¨‹ï¼Œä½†æ˜¯Shuffleè¿‡ç¨‹åªæ˜¯ä»ç¬¬7æ­¥å¼€å§‹åˆ°ç¬¬16æ­¥ç»“æŸï¼Œå…·ä½“Shuffleè¿‡ç¨‹è¯¦è§£ï¼Œå¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰MapTaskæ”¶é›†æˆ‘ä»¬çš„map()æ–¹æ³•è¾“å‡ºçš„kvå¯¹ï¼Œæ”¾åˆ°å†…å­˜ç¼“å†²åŒºä¸­</p>
<p>ï¼ˆ2ï¼‰ä»å†…å­˜ç¼“å†²åŒºä¸æ–­æº¢å‡ºæœ¬åœ°ç£ç›˜æ–‡ä»¶ï¼Œå¯èƒ½ä¼šæº¢å‡ºå¤šä¸ªæ–‡ä»¶</p>
<p>ï¼ˆ3ï¼‰å¤šä¸ªæº¢å‡ºæ–‡ä»¶ä¼šè¢«åˆå¹¶æˆå¤§çš„æº¢å‡ºæ–‡ä»¶</p>
<p>ï¼ˆ4ï¼‰åœ¨æº¢å‡ºè¿‡ç¨‹åŠåˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½è¦è°ƒç”¨Partitionerè¿›è¡Œåˆ†åŒºå’Œé’ˆå¯¹keyè¿›è¡Œæ’åº</p>
<p>ï¼ˆ5ï¼‰ReduceTaskæ ¹æ®è‡ªå·±çš„åˆ†åŒºå·ï¼Œå»å„ä¸ªMapTaskæœºå™¨ä¸Šå–ç›¸åº”çš„ç»“æœåˆ†åŒºæ•°æ®</p>
<p>ï¼ˆ6ï¼‰ReduceTaskä¼šæŠ“å–åˆ°åŒä¸€ä¸ªåˆ†åŒºçš„æ¥è‡ªä¸åŒMapTaskçš„ç»“æœæ–‡ä»¶ï¼ŒReduceTaskä¼šå°†è¿™äº›æ–‡ä»¶å†è¿›è¡Œåˆå¹¶ï¼ˆå½’å¹¶æ’åºï¼‰</p>
<p>ï¼ˆ7ï¼‰åˆå¹¶æˆå¤§æ–‡ä»¶åï¼ŒShuffleçš„è¿‡ç¨‹ä¹Ÿå°±ç»“æŸäº†ï¼Œåé¢è¿›å…¥ReduceTaskçš„é€»è¾‘è¿ç®—è¿‡ç¨‹ï¼ˆä»æ–‡ä»¶ä¸­å–å‡ºä¸€ä¸ªä¸€ä¸ªçš„é”®å€¼å¯¹Groupï¼Œè°ƒç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„reduce()æ–¹æ³•ï¼‰</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>ï¼ˆ1ï¼‰Shuffleä¸­çš„ç¼“å†²åŒºå¤§å°ä¼šå½±å“åˆ°MapReduceç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼ŒåŸåˆ™ä¸Šè¯´ï¼Œç¼“å†²åŒºè¶Šå¤§ï¼Œç£ç›˜ioçš„æ¬¡æ•°è¶Šå°‘ï¼Œæ‰§è¡Œé€Ÿåº¦å°±è¶Šå¿«ã€‚</p>
<p>ï¼ˆ2ï¼‰ç¼“å†²åŒºçš„å¤§å°å¯ä»¥é€šè¿‡å‚æ•°è°ƒæ•´ï¼Œå‚æ•°ï¼šmapreduce.task.io.sort.mbé»˜è®¤100Mã€‚</p>
<p><strong>Map æ–¹æ³•ä¹‹åï¼ŒReduce æ–¹æ³•ä¹‹å‰çš„æ•°æ®å¤„ç†è¿‡ç¨‹ç§°ä¹‹ä¸º Shuffer</strong></p>
<img src="/2022/03/06/hadoop/1646563217632.png" class="" width="1646563217632">

<h3 id="Partitionåˆ†åŒº"><a href="#Partitionåˆ†åŒº" class="headerlink" title="Partitionåˆ†åŒº"></a>Partitionåˆ†åŒº</h3><p>â€‹    é»˜è®¤åˆ†åŒºæ˜¯æ ¹æ®keyçš„hashCodeå¯¹ReduceTasksä¸ªæ•°å–æ¨¡å¾—åˆ°çš„ã€‚ç”¨æˆ·æ²¡æ³•æ§åˆ¶å“ªä¸ªkeyå­˜å‚¨åˆ°å“ªä¸ªåˆ†åŒºã€‚</p>
<p><img src="/1646472095363.png" alt="1646472095363"></p>
<p>!<img src="/1646472279827.png" alt="1646472279827">(1646472264084.png)</p>
<p><strong>KVè®¾ç½®ä¸ºmapè¾“å‡ºçš„KV</strong></p>
<h4 id="åˆ†åŒºæ€»ç»“"><a href="#åˆ†åŒºæ€»ç»“" class="headerlink" title="åˆ†åŒºæ€»ç»“"></a>åˆ†åŒºæ€»ç»“</h4><ol>
<li><p>å¦‚æœRedhceTaskçš„æ•°é‡ &gt; getPantitionçš„ç»“æœæ•°ï¼Œåˆ™ä¼šå¤šäº§ç”Ÿå‡ ä¸ªç©ºçš„è¾“å‡ºæ–‡ä»¶part-r-000xx;</p>
</li>
<li><p>å¦‚æœ1 &lt; ReduceTaskçš„æ•°é‡ &lt; getPartitionçš„ç»“æœæ•°ï¼Œåˆ™æœ‰ä¸€éƒ¨åˆ†åˆ†åŒºæ•°æ®æ— å¤„å®‰æ”¾ï¼Œä¼šException;</p>
</li>
<li><p>å¦‚æœReduceTaskçš„æ•°é‡ &#x3D; 1ï¼Œ<strong>ä¸æ‰§è¡Œåˆ†åŒºæ“ä½œï¼Œåœ¨æ‰§è¡Œä¹‹å‰é¦–å…ˆè¦åˆ¤æ–­ReduceTasæ•°é‡æ˜¯å¦ä¸º1</strong>æœ€ç»ˆç»“æœéƒ½äº¤ç»™è¿™ä¸€ä¸ªReduceTaskï¼Œæœ€ç»ˆä¹Ÿå°±åªä¼šäº§ç”Ÿä¸€ä¸ªç»“æœæ–‡ä»¶part-r-00000;</p>
</li>
<li><p>åˆ†åŒºå·å¿…é¡»ä»é›¶å¼€å§‹ï¼Œé€ä¸€ç´¯åŠ ã€‚</p>
<p><img src="/1646472445540.png" alt="1646472445540"></p>
</li>
</ol>
<h3 id="WritableComparableæ’åº"><a href="#WritableComparableæ’åº" class="headerlink" title="WritableComparableæ’åº"></a>WritableComparableæ’åº</h3><img src="/2022/03/06/hadoop/1646563228969.png" class="" width="1646563228969">

<ol>
<li>éƒ¨åˆ†æ’åº<br>MapReduceæ ¹æ®è¾“å…¥è®°å½•çš„é”®å¯¹æ•°æ®é›†æ’åºã€‚ä¿è¯è¾“å‡ºçš„æ¯ä¸ªæ–‡ä»¶å†…éƒ¨æœ‰åºã€‚</li>
<li>å…¨æ’åº<br>æœ€ç»ˆè¾“å‡ºç»“æœåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸”æ–‡ä»¶å†…éƒ¨æœ‰åºã€‚å®ç°æ–¹å¼æ˜¯åªè®¾ç½®ä¸€ä¸ªReduceTaskã€‚ä½†è¯¥æ–¹æ³•åœ¨å¤„ç†å¤§å‹æ–‡ä»¶æ—¶æ•ˆç‡æä½ï¼Œå› ä¸ºä¸€å°æœºå™¨å¤„ç†æ‰€æœ‰æ–‡ä»¶ï¼Œå®Œå…¨ä¸§å¤±äº†MapReduceæ‰€æä¾›çš„å¹¶è¡Œæ¶æ„ã€‚</li>
<li>è¾…åŠ©æ’åº:(GroupingComparatoråˆ†ç»„)<br>åœ¨Reduceç«¯å¯¹keyè¿›è¡Œåˆ†ç»„ã€‚åº”ç”¨äº:åœ¨æ¥æ”¶çš„keyä¸ºbeanå¯¹è±¡æ—¶ï¼Œæƒ³è®©ä¸€ä¸ªæˆ–å‡ ä¸ªå­—æ®µç›¸åŒï¼ˆå…¨éƒ¨<br>å­—æ®µæ¯”è¾ƒä¸ç›¸åŒ)çš„keyè¿›å…¥åˆ°åŒä¸€ä¸ªreduceæ–¹æ³•æ—¶ï¼Œå¯ä»¥é‡‡ç”¨åˆ†ç»„æ’åºã€‚</li>
<li>äºŒæ¬¡æ’åº<br>åœ¨è‡ªå®šä¹‰æ’åºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœcompareToä¸­çš„åˆ¤æ–­æ¡ä»¶ä¸ºä¸¤ä¸ªå³ä¸ºäºŒæ¬¡æ’åºã€‚</li>
</ol>
<h3 id="Combineråˆå¹¶"><a href="#Combineråˆå¹¶" class="headerlink" title="Combineråˆå¹¶"></a><strong>Combineråˆå¹¶</strong></h3><ol>
<li><p>Combineræ˜¯MRç¨‹åºä¸­Mapperå’ŒReducerä¹‹å¤–çš„ä¸€ç§ç»„ä»¶ã€‚</p>
</li>
<li><p>Combinerç»„ä»¶çš„çˆ¶ç±»å°±æ˜¯Redicerã€‚</p>
</li>
<li><p>Combinerå’ŒReducençš„åŒºåˆ«åœ¨äºè¿è¡Œçš„ä½ç½®Combineræ˜¯åœ¨æ¯ä¸€ä¸ªMapTaskæ‰€åœ¨çš„èŠ‚ç‚¹è¿è¡Œ;Reduceræ˜¯æ¥æ”¶å…¨å±€æ‰€æœ‰Mappençš„è¾“å‡ºç»“æœ;</p>
<p>Combinerçš„æ„ä¹‰å°±æ˜¯å¯¹æ¯ä¸€ä¸ªMapTaskçš„è¾“å‡ºè¿›è¡Œå±€éƒ¨æ±‡æ€»ï¼Œä»¥å‡å°ç½‘ç»œä¼ è¾“é‡ã€‚</p>
</li>
<li><p>Combinerèƒ½å¤Ÿåº”ç”¨çš„å‰ææ˜¯ä¸èƒ½å½±å“æœ€ç»ˆçš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸”ï¼ŒCombinerçš„è¾“å‡ºkvåº”è¯¥è·ŸReducerçš„è¾“å…¥kvç±»å‹è¦å¯¹åº”èµ·æ¥ã€‚</p>
</li>
</ol>
<p><strong>ï¼ï¼ï¼æ±‚å¹³å‡å€¼çš„æƒ…å†µä¸èƒ½ç”¨Combiner ä¼šå¯¼è‡´ç»“æœä¸æ­£ç¡®ã€‚</strong></p>
<p>æ±‚å’Œæ—¶å¯ä»¥åˆ©ç”¨Combiner</p>
<p><em><strong>Combinerä¸»è¦æ˜¯ä½œä¸ºä¸€ä¸ªå°å‹çš„Rediceråœ¨æ¯ä¸€ä¸ªMapTaskä¸Šè¿›è¡Œæ±‚å’Œè®¡ç®—ï¼Œä»è€Œå‡å°‘æ•°æ®ä¼ è¾“å¯¼è‡´çš„æ—¶é—´è¿‡é•¿</strong></em></p>
<h3 id="OutputFormatæ•°æ®è¾“å‡º"><a href="#OutputFormatæ•°æ®è¾“å‡º" class="headerlink" title="OutputFormatæ•°æ®è¾“å‡º"></a>OutputFormatæ•°æ®è¾“å‡º</h3><p>   é»˜è®¤è¾“å‡ºæ ¼å¼ä¸ºTextOutputFormat   ä¸€è¡Œä¸€è¡Œå†™åˆ°textæ–‡ä»¶ä¸­</p>
<h5 id="è‡ªå®šä¹‰OutputFormatç±»"><a href="#è‡ªå®šä¹‰OutputFormatç±»" class="headerlink" title="è‡ªå®šä¹‰OutputFormatç±»"></a>è‡ªå®šä¹‰OutputFormatç±»</h5><ul>
<li>è‡ªå®šä¹‰ä¸€ä¸ªç±»ç»§æ‰¿FileOutputFormatã€‚</li>
<li>æ”¹RecordWriterï¼Œå…·ä½“æ”¹å†™æ–¹æ³•writeï¼ˆï¼‰</li>
</ul>
<p><strong>æ–¹æ³•ï¼š</strong></p>
<ul>
<li>â€‹    è‡ªå®šä¹‰MyFileOutputFormatç±»åé‡å†™getRecordWriter()å‡½æ•°ï¼Œè®¾ç½®è¿”å›å€¼çš„ç±»å‹ä¸ºKV,å‘è‡ªå®šä¹‰MYRecordWriterç±»ä¼ é€’jobã€‚</li>
<li>â€‹    åœ¨æ„é€ å‡½æ•°ä¸­è·å–ä¼ æ¥çš„jobï¼Œå®šä¹‰è¾“å‡ºæµï¼ˆå†™å‡ºè·¯å¾„ï¼‰ï¼Œé‡å†™writer&lt;K,V&gt;æ–¹æ³•ï¼Œæ ¹æ®æ¡ä»¶é€‰æ‹©è¾“å‡ºæµã€‚</li>
<li>â€‹    åœ¨closeï¼ˆï¼‰æ–¹æ³•ä¸­å…³é—­åˆ›å»ºçš„è¾“å‡ºæµã€‚</li>
</ul>
<h3 id="MapReduceå†…æ ¸æºç è§£æ"><a href="#MapReduceå†…æ ¸æºç è§£æ" class="headerlink" title="MapReduceå†…æ ¸æºç è§£æ"></a>MapReduceå†…æ ¸æºç è§£æ</h3><h4 id="MapTaskå·¥ä½œæœºåˆ¶"><a href="#MapTaskå·¥ä½œæœºåˆ¶" class="headerlink" title="MapTaskå·¥ä½œæœºåˆ¶"></a>MapTaskå·¥ä½œæœºåˆ¶</h4><img src="/2022/03/06/hadoop/1646563236218.png" class="" width="1646563236218">

<ul>
<li><font color='red'>Readé˜¶æ®µ</font>ï¼šMapTaské€šè¿‡InputFormatè·å¾—çš„RecordReaderï¼Œä»è¾“å…¥InputSplitä¸­è§£æå‡ºä¸€ä¸ªä¸ªkey&#x2F;valueã€‚</li>
<li><font color='red'>Mapé˜¶æ®µ</font>ï¼šè¯¥èŠ‚ç‚¹ä¸»è¦æ˜¯å°†è§£æå‡ºçš„key&#x2F;valueäº¤ç»™ç”¨æˆ·ç¼–å†™map()å‡½æ•°å¤„ç†ï¼Œå¹¶äº§ç”Ÿä¸€ç³»åˆ—æ–°çš„key&#x2F;valueã€‚</li>
<li><font color='red'>Collectæ”¶é›†é˜¶æ®µ</font>ï¼šåœ¨ç”¨æˆ·ç¼–å†™map()å‡½æ•°ä¸­ï¼Œå½“æ•°æ®å¤„ç†å®Œæˆåï¼Œä¸€èˆ¬ä¼šè°ƒç”¨OutputCollector.collect()è¾“å‡ºç»“æœã€‚åœ¨è¯¥å‡½æ•°å†…éƒ¨ï¼Œå®ƒä¼šå°†ç”Ÿæˆçš„key&#x2F;valueåˆ†åŒºï¼ˆè°ƒç”¨Partitionerï¼‰ï¼Œå¹¶å†™å…¥ä¸€ä¸ªç¯å½¢å†…å­˜ç¼“å†²åŒºä¸­ã€‚</li>
<li><font color='red'>Spillé˜¶æ®µ</font>ï¼šå³â€œæº¢å†™â€ï¼Œå½“ç¯å½¢ç¼“å†²åŒºæ»¡åï¼ŒMapReduceä¼šå°†æ•°æ®å†™åˆ°æœ¬åœ°ç£ç›˜ä¸Šï¼Œç”Ÿæˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜ä¹‹å‰ï¼Œå…ˆè¦å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡æœ¬åœ°æ’åºï¼Œå¹¶åœ¨å¿…è¦æ—¶å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ã€å‹ç¼©ç­‰æ“ä½œã€‚</li>
</ul>
<p>æº¢å†™é˜¶æ®µè¯¦æƒ…ï¼š</p>
<p>â€‹    æ­¥éª¤1ï¼šåˆ©ç”¨å¿«é€Ÿæ’åºç®—æ³•å¯¹ç¼“å­˜åŒºå†…çš„æ•°æ®è¿›è¡Œæ’åºï¼Œæ’åºæ–¹å¼æ˜¯ï¼Œå…ˆæŒ‰ç…§åˆ†åŒºç¼–å·Partitionè¿›è¡Œæ’åºï¼Œç„¶åæŒ‰ç…§keyè¿›è¡Œæ’åºã€‚è¿™æ ·ï¼Œç»è¿‡æ’åºåï¼Œæ•°æ®ä»¥åˆ†åŒºä¸ºå•ä½èšé›†åœ¨ä¸€èµ·ï¼Œä¸”åŒä¸€åˆ†åŒºå†…æ‰€æœ‰æ•°æ®æŒ‰ç…§keyæœ‰åºã€‚</p>
<p>â€‹    æ­¥éª¤2ï¼šæŒ‰ç…§åˆ†åŒºç¼–å·ç”±å°åˆ°å¤§ä¾æ¬¡å°†æ¯ä¸ªåˆ†åŒºä¸­çš„æ•°æ®å†™å…¥ä»»åŠ¡å·¥ä½œç›®å½•ä¸‹çš„ä¸´æ—¶æ–‡ä»¶output&#x2F;spillN.outï¼ˆNè¡¨ç¤ºå½“å‰æº¢å†™æ¬¡æ•°ï¼‰ä¸­ã€‚å¦‚æœç”¨æˆ·è®¾ç½®äº†Combinerï¼Œåˆ™å†™å…¥æ–‡ä»¶ä¹‹å‰ï¼Œå¯¹æ¯ä¸ªåˆ†åŒºä¸­çš„æ•°æ®è¿›è¡Œä¸€æ¬¡èšé›†æ“ä½œã€‚</p>
<p>â€‹    æ­¥éª¤3ï¼šå°†åˆ†åŒºæ•°æ®çš„å…ƒä¿¡æ¯å†™åˆ°å†…å­˜ç´¢å¼•æ•°æ®ç»“æ„SpillRecordä¸­ï¼Œå…¶ä¸­æ¯ä¸ªåˆ†åŒºçš„å…ƒä¿¡æ¯åŒ…æ‹¬åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­çš„åç§»é‡ã€å‹ç¼©å‰æ•°æ®å¤§å°å’Œå‹ç¼©åæ•°æ®å¤§å°ã€‚å¦‚æœå½“å‰å†…å­˜ç´¢å¼•å¤§å°è¶…è¿‡1MBï¼Œåˆ™å°†å†…å­˜ç´¢å¼•å†™åˆ°æ–‡ä»¶output&#x2F;spillN.out.indexä¸­ã€‚</p>
<ul>
<li><p><font color='red'>Mergeé˜¶æ®µ</font>ï¼šå½“æ‰€æœ‰æ•°æ®å¤„ç†å®Œæˆåï¼ŒMapTaskå¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶è¿›è¡Œä¸€æ¬¡åˆå¹¶ï¼Œä»¥ç¡®ä¿æœ€ç»ˆåªä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®æ–‡ä»¶ã€‚</p>
<p>â€‹    å½“æ‰€æœ‰æ•°æ®å¤„ç†å®Œåï¼ŒMapTaskä¼šå°†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ°æ–‡ä»¶output&#x2F;file.outä¸­ï¼ŒåŒæ—¶ç”Ÿæˆç›¸åº”çš„ç´¢å¼•æ–‡ä»¶output&#x2F;file.out.indexã€‚</p>
<p>â€‹    åœ¨è¿›è¡Œæ–‡ä»¶åˆå¹¶è¿‡ç¨‹ä¸­ï¼ŒMapTaskä»¥åˆ†åŒºä¸ºå•ä½è¿›è¡Œåˆå¹¶ã€‚å¯¹äºæŸä¸ªåˆ†åŒºï¼Œå®ƒå°†é‡‡ç”¨å¤šè½®é€’å½’åˆå¹¶çš„å¼ã€‚æ¯è½®åˆå¹¶mapreduce.task.io.sort.factorï¼ˆé»˜è®¤10ï¼‰ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†äº§ç”Ÿçš„æ–‡ä»¶é‡æ–°åŠ å…¥å¾…åˆå¹¶åˆ—è¡¨ä¸­ï¼Œå¯¹æ–‡ä»¶æ’åºåï¼Œé‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œç›´åˆ°æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¤§æ–‡ä»¶ã€‚</p>
<p>â€‹    è®©æ¯ä¸ªMapTaskæœ€ç»ˆåªç”Ÿæˆä¸€ä¸ªæ•°æ®æ–‡ä»¶ï¼Œå¯é¿å…åŒæ—¶æ‰“å¼€å¤§é‡æ–‡ä»¶å’ŒåŒæ—¶è¯»å–å¤§é‡å°æ–‡ä»¶äº§ç”Ÿçš„éšæœºè¯»å–å¸¦æ¥çš„å¼€é”€ã€‚</p>
</li>
</ul>
<h4 id="ReduceTaskå·¥ä½œæœºåˆ¶"><a href="#ReduceTaskå·¥ä½œæœºåˆ¶" class="headerlink" title="ReduceTaskå·¥ä½œæœºåˆ¶"></a><strong>ReduceTaskå·¥ä½œæœºåˆ¶</strong></h4><p><img src="/1646529956381.png" alt="img"></p>
<ol>
<li>Copyé˜¶æ®µï¼šReduceTaskä»å„ä¸ªMapTaskä¸Šè¿œç¨‹æ‹·è´ä¸€ç‰‡æ•°æ®ï¼Œå¹¶é’ˆå¯¹æŸä¸€ç‰‡æ•°æ®ï¼Œå¦‚æœå…¶å¤§å°è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™å†™åˆ°ç£ç›˜ä¸Šï¼Œå¦åˆ™ç›´æ¥æ”¾åˆ°å†…å­˜ä¸­ã€‚</li>
<li>Sorté˜¶æ®µï¼šåœ¨è¿œç¨‹æ‹·è´æ•°æ®çš„åŒæ—¶ï¼ŒReduceTaskå¯åŠ¨äº†ä¸¤ä¸ªåå°çº¿ç¨‹å¯¹å†…å­˜å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œä»¥é˜²æ­¢å†…å­˜ä½¿ç”¨è¿‡å¤šæˆ–ç£ç›˜ä¸Šæ–‡ä»¶è¿‡å¤šã€‚æŒ‰ç…§MapReduceè¯­ä¹‰ï¼Œç”¨æˆ·ç¼–å†™reduce()å‡½æ•°è¾“å…¥æ•°æ®æ˜¯æŒ‰keyè¿›è¡Œèšé›†çš„ä¸€ç»„æ•°æ®ã€‚ä¸ºäº†å°†keyç›¸åŒçš„æ•°æ®èšåœ¨ä¸€èµ·ï¼ŒHadoopé‡‡ç”¨äº†åŸºäºæ’åºçš„ç­–ç•¥ã€‚ç”±äºå„ä¸ªMapTaskå·²ç»å®ç°å¯¹è‡ªå·±çš„å¤„ç†ç»“æœè¿›è¡Œäº†å±€éƒ¨æ’åºï¼Œå› æ­¤ï¼ŒReduceTaskåªéœ€å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œä¸€æ¬¡å½’å¹¶æ’åºå³å¯ã€‚</li>
<li>Reduceé˜¶æ®µï¼šreduce()å‡½æ•°å°†è®¡ç®—ç»“æœå†™åˆ°HDFSä¸Šã€‚</li>
</ol>
<h4 id="ReduceTaskå¹¶è¡Œåº¦å†³å®šæœºåˆ¶"><a href="#ReduceTaskå¹¶è¡Œåº¦å†³å®šæœºåˆ¶" class="headerlink" title="ReduceTaskå¹¶è¡Œåº¦å†³å®šæœºåˆ¶"></a>ReduceTaskå¹¶è¡Œåº¦å†³å®šæœºåˆ¶</h4><p>****å›é¡¾ï¼š****MapTaskå¹¶è¡Œåº¦ç”±åˆ‡ç‰‡ä¸ªæ•°å†³å®šï¼Œåˆ‡ç‰‡ä¸ªæ•°ç”±è¾“å…¥æ–‡ä»¶å’Œåˆ‡ç‰‡è§„åˆ™å†³å®šã€‚</p>
<p>****æ€è€ƒï¼š****ReduceTaskå¹¶è¡Œåº¦ç”±è°å†³å®šï¼Ÿ</p>
<p>ReduceTaskæ•°é‡çš„å†³å®šæ˜¯å¯ä»¥ç›´æ¥æ‰‹åŠ¨è®¾ç½®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// é»˜è®¤å€¼æ˜¯1ï¼Œæ‰‹åŠ¨è®¾ç½®ä¸º4</span><br><span class="line">job.setNumReduceTasks(4);</span><br></pre></td></tr></table></figure>

<img src="/2022/03/06/hadoop/1646563282412.png" class="" width="1646563282412">

<h3 id="Join-åº”ç”¨"><a href="#Join-åº”ç”¨" class="headerlink" title="Join åº”ç”¨"></a><strong>Join</strong> <strong>åº”ç”¨</strong></h3><h4 id="Reduce-Join"><a href="#Reduce-Join" class="headerlink" title="Reduce Join"></a><strong>Reduce Join</strong></h4><p>â€‹    Map ç«¯çš„ä¸»è¦å·¥ä½œï¼šä¸ºæ¥è‡ªä¸åŒè¡¨æˆ–æ–‡ä»¶çš„ key&#x2F;value å¯¹ï¼Œæ‰“æ ‡ç­¾ä»¥åŒºåˆ«ä¸åŒæ¥æºçš„è®° </p>
<p>å½•ã€‚ç„¶åç”¨è¿æ¥å­—æ®µä½œä¸º keyï¼Œå…¶ä½™éƒ¨åˆ†å’Œæ–°åŠ çš„æ ‡å¿—ä½œä¸º valueï¼Œæœ€åè¿›è¡Œè¾“å‡ºã€‚ </p>
<p>â€‹     Reduce ç«¯çš„ä¸»è¦å·¥ä½œï¼šåœ¨ Reduce ç«¯ä»¥è¿æ¥å­—æ®µä½œä¸º key çš„åˆ†ç»„å·²ç»å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦ </p>
<p>åœ¨æ¯ä¸€ä¸ªåˆ†ç»„å½“ä¸­å°†é‚£äº›æ¥æºäºä¸åŒæ–‡ä»¶çš„è®°å½•ï¼ˆåœ¨ Map é˜¶æ®µå·²ç»æ‰“æ ‡å¿—ï¼‰åˆ†å¼€ï¼Œæœ€åè¿› </p>
<p>è¡Œåˆå¹¶.</p>
<h4 id="Map-Join"><a href="#Map-Join" class="headerlink" title="Map Join"></a><strong>Map Join</strong></h4><p><strong>1</strong>ï¼‰ä½¿ç”¨åœºæ™¯</p>
<p>Map Join é€‚ç”¨äºä¸€å¼ è¡¨ååˆ†å°ã€ä¸€å¼ è¡¨å¾ˆå¤§çš„åœºæ™¯ã€‚ </p>
<p><strong>2</strong>ï¼‰ä¼˜ç‚¹</p>
<p>æ€è€ƒï¼šåœ¨ Reduce ç«¯å¤„ç†è¿‡å¤šçš„è¡¨ï¼Œéå¸¸å®¹æ˜“äº§ç”Ÿæ•°æ®å€¾æ–œã€‚æ€ä¹ˆåŠï¼Ÿ </p>
<p>åœ¨ Map ç«¯ç¼“å­˜å¤šå¼ è¡¨ï¼Œæå‰å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè¿™æ ·å¢åŠ  Map ç«¯ä¸šåŠ¡ï¼Œå‡å°‘ Reduce ç«¯æ•° </p>
<p>æ®çš„å‹åŠ›ï¼Œå°½å¯èƒ½çš„å‡å°‘æ•°æ®å€¾æ–œã€‚ </p>
<p><strong>3</strong>ï¼‰å…·ä½“åŠæ³•ï¼šé‡‡ç”¨ <strong>DistributedCache</strong> </p>
<p>ï¼ˆ1ï¼‰åœ¨ Mapper çš„ setup é˜¶æ®µï¼Œå°†æ–‡ä»¶è¯»å–åˆ°ç¼“å­˜é›†åˆä¸­ã€‚ </p>
<p>ï¼ˆ2ï¼‰åœ¨ Driver é©±åŠ¨ç±»ä¸­åŠ è½½ç¼“å­˜ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç¼“å­˜æ™®é€šæ–‡ä»¶åˆ° Task è¿è¡ŒèŠ‚ç‚¹ã€‚</span><br><span class="line">job.addCacheFile(new URI(&quot;file:///e:/cache/pd.txt&quot;));</span><br><span class="line">//å¦‚æœæ˜¯é›†ç¾¤è¿è¡Œ,éœ€è¦è®¾ç½® HDFS è·¯å¾„</span><br><span class="line">job.addCacheFile(new URI(&quot;hdfs://hadoop102:8020/cache/pd.txt&quot;));</span><br></pre></td></tr></table></figure>

<h3 id="ETL"><a href="#ETL" class="headerlink" title="ETL"></a>ETL</h3><p>æ•°æ®æ¸…æ´—å¾€å¾€åœ¨mapé˜¶æ®µå°±å®ç°äº†ï¼Œä¸éœ€è¦reduceé˜¶æ®µ ï¼Œå¦‚æœåªéœ€è¦æ•°æ®æ¸…æ´—å¯ä»¥å°†reducetaskè®¾ç½®ä¸º0ä¸ª</p>
<h3 id="MapReduce-å¼€å‘æ€»ç»“"><a href="#MapReduce-å¼€å‘æ€»ç»“" class="headerlink" title="MapReduce å¼€å‘æ€»ç»“"></a><strong>MapReduce</strong> <strong>å¼€å‘æ€»ç»“</strong></h3><p>1.è¾“å…¥æ•°æ®æ¥å£ï¼š<strong>InputFormat</strong> </p>
<p>â€‹    ï¼ˆ1ï¼‰é»˜è®¤ä½¿ç”¨çš„å®ç°ç±»æ˜¯ï¼šTextInputFormat </p>
<p>â€‹    ï¼ˆ2ï¼‰TextInputFormat çš„åŠŸèƒ½é€»è¾‘æ˜¯ï¼šä¸€æ¬¡è¯»ä¸€è¡Œæ–‡æœ¬ï¼Œç„¶åå°†è¯¥è¡Œçš„èµ·å§‹åç§»é‡ä½œä¸º keyï¼Œè¡Œå†…å®¹ä½œä¸º value è¿”å›ã€‚ </p>
<p>â€‹    ï¼ˆ3ï¼‰CombineTextInputFormat å¯ä»¥æŠŠå¤šä¸ªå°æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªåˆ‡ç‰‡å¤„ç†ï¼Œæé«˜å¤„ç†æ•ˆç‡ã€‚ </p>
<p>2.é€»è¾‘å¤„ç†æ¥å£ï¼š<strong>Mapper</strong>  </p>
<p>â€‹    ç”¨æˆ·æ ¹æ®ä¸šåŠ¡éœ€æ±‚å®ç°å…¶ä¸­ä¸‰ä¸ªæ–¹æ³•ï¼š setup() map() cleanup ()  </p>
<p><strong>3.Partitioner</strong> <strong>åˆ†åŒº</strong> </p>
<p>â€‹    ï¼ˆ1ï¼‰æœ‰é»˜è®¤å®ç° HashPartitionerï¼Œé€»è¾‘æ˜¯æ ¹æ® key çš„å“ˆå¸Œå€¼å’Œ numReduces æ¥è¿”å›ä¸€ä¸ªåˆ†åŒºå·ï¼›key.hashCode()&amp;Integer.MAXVALUE % numReduces </p>
<p>â€‹    ï¼ˆ2ï¼‰å¦‚æœä¸šåŠ¡ä¸Šæœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†åŒºã€‚ </p>
<p><strong>4.Comparable</strong> <strong>æ’åº</strong></p>
<p>â€‹    ï¼ˆ1ï¼‰å½“æˆ‘ä»¬ç”¨è‡ªå®šä¹‰çš„å¯¹è±¡ä½œä¸º key æ¥è¾“å‡ºæ—¶ï¼Œå°±å¿…é¡»è¦å®ç° WritableComparable æ¥å£ï¼Œé‡å†™å…¶ä¸­çš„ compareTo()æ–¹æ³•ã€‚ </p>
<p>â€‹    ï¼ˆ2ï¼‰éƒ¨åˆ†æ’åºï¼šå¯¹æœ€ç»ˆè¾“å‡ºçš„æ¯ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå†…éƒ¨æ’åºã€‚ </p>
<p>â€‹    ï¼ˆ3ï¼‰å…¨æ’åºï¼šå¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œæ’åºï¼Œé€šå¸¸åªæœ‰ä¸€ä¸ª Reduceã€‚ </p>
<p>â€‹    ï¼ˆ4ï¼‰äºŒæ¬¡æ’åºï¼šæ’åºçš„æ¡ä»¶æœ‰ä¸¤ä¸ªã€‚ </p>
<p><strong>5.Combiner</strong> <strong>åˆå¹¶</strong> </p>
<p>â€‹    Combiner åˆå¹¶å¯ä»¥æé«˜ç¨‹åºæ‰§è¡Œæ•ˆç‡ï¼Œå‡å°‘ IO ä¼ è¾“ã€‚ä½†æ˜¯ä½¿ç”¨æ—¶å¿…é¡»ä¸èƒ½å½±å“åŸæœ‰çš„ä¸šåŠ¡å¤„ç†ç»“æœã€‚ </p>
<p>6.é€»è¾‘å¤„ç†æ¥å£ï¼š<strong>Reducer</strong> </p>
<p>â€‹    ç”¨æˆ·æ ¹æ®ä¸šåŠ¡éœ€æ±‚å®ç°å…¶ä¸­ä¸‰ä¸ªæ–¹æ³•ï¼šreduce() setup() cleanup ()  </p>
<p>7.è¾“å‡ºæ•°æ®æ¥å£ï¼š<strong>OutputFormat</strong> </p>
<p>â€‹    ï¼ˆ1ï¼‰é»˜è®¤å®ç°ç±»æ˜¯ TextOutputFormatï¼ŒåŠŸèƒ½é€»è¾‘æ˜¯ï¼šå°†æ¯ä¸€ä¸ª KV å¯¹ï¼Œå‘ç›®æ ‡æ–‡æœ¬æ–‡ä»¶è¾“å‡ºä¸€è¡Œã€‚ </p>
<p>â€‹    ï¼ˆ2ï¼‰ç”¨æˆ·è¿˜å¯ä»¥è‡ªå®šä¹‰ OutputFormatã€‚ </p>
<h3 id="Hadoop-æ•°æ®å‹ç¼©"><a href="#Hadoop-æ•°æ®å‹ç¼©" class="headerlink" title="Hadoop æ•°æ®å‹ç¼©"></a><strong>Hadoop</strong> <strong>æ•°æ®å‹ç¼©</strong></h3><h4 id="å‹ç¼©çš„å¥½å¤„å’Œåå¤„ï¼š"><a href="#å‹ç¼©çš„å¥½å¤„å’Œåå¤„ï¼š" class="headerlink" title="å‹ç¼©çš„å¥½å¤„å’Œåå¤„ï¼š"></a><strong>å‹ç¼©çš„å¥½å¤„å’Œåå¤„ï¼š</strong></h4><p>â€‹    å‹ç¼©çš„ä¼˜ç‚¹ï¼šä»¥å‡å°‘ç£ç›˜ IOã€å‡å°‘ç£ç›˜å­˜å‚¨ç©ºé—´ã€‚ </p>
<p>â€‹    å‹ç¼©çš„ç¼ºç‚¹ï¼šå¢åŠ  CPU å¼€é”€ã€‚</p>
<h4 id="å‹ç¼©åŸåˆ™ï¼š"><a href="#å‹ç¼©åŸåˆ™ï¼š" class="headerlink" title="å‹ç¼©åŸåˆ™ï¼š"></a><strong>å‹ç¼©åŸåˆ™ï¼š</strong></h4><p>â€‹    ï¼ˆ1ï¼‰è¿ç®—å¯†é›†å‹çš„ Jobï¼Œå°‘ç”¨å‹ç¼© </p>
<p>â€‹    ï¼ˆ2ï¼‰IO å¯†é›†å‹çš„ Jobï¼Œå¤šç”¨å‹ç¼© </p>
<h4 id="å‹ç¼©æ–¹å¼é€‰ï¼š"><a href="#å‹ç¼©æ–¹å¼é€‰ï¼š" class="headerlink" title="å‹ç¼©æ–¹å¼é€‰ï¼š"></a><strong>å‹ç¼©æ–¹å¼é€‰ï¼š</strong></h4><p>â€‹    å‹ç¼©æ–¹å¼é€‰æ‹©æ—¶é‡ç‚¹è€ƒè™‘ï¼š<strong>å‹ç¼©&#x2F;è§£å‹ç¼©é€Ÿåº¦ã€å‹ç¼©ç‡ï¼ˆå‹ç¼©åå­˜å‚¨å¤§å°ï¼‰ã€å‹ç¼©åæ˜¯å¦å¯ä»¥æ”¯æŒåˆ‡ç‰‡</strong>ã€‚</p>
<h4 id="å‹ç¼©ä½ç½®é€‰æ‹©ï¼š"><a href="#å‹ç¼©ä½ç½®é€‰æ‹©ï¼š" class="headerlink" title="å‹ç¼©ä½ç½®é€‰æ‹©ï¼š"></a><strong>å‹ç¼©ä½ç½®é€‰æ‹©ï¼š</strong></h4><p>â€‹    å‹ç¼©å¯ä»¥åœ¨ MapReduce ä½œç”¨çš„ä»»æ„é˜¶æ®µå¯ç”¨ã€‚ </p>
<img src="/2022/03/06/hadoop/1646563292818.png" class="" width="1646563292818">

<table>
<thead>
<tr>
<th>å‹ç¼©æ ¼å¼</th>
<th>å¯¹åº”çš„ç¼–ç &#x2F;è§£ç å™¨</th>
</tr>
</thead>
<tbody><tr>
<td>DEFLATE</td>
<td>org.apache.hadoop.io.compress.DefaultCodec</td>
</tr>
<tr>
<td>gzip</td>
<td>org.apache.hadoop.io.compress.GzipCodec</td>
</tr>
<tr>
<td>bzip2</td>
<td>org.apache.hadoop.io.compress.BZip2Codec</td>
</tr>
<tr>
<td>LZO</td>
<td>com.hadoop.compression.lzo.LzopCodec</td>
</tr>
<tr>
<td>Snappy</td>
<td>org.apache.hadoop.io.compress.SnappyCodec</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>é»˜è®¤å€¼</th>
<th>é˜¶æ®µ</th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>io.compression.codecs  ï¼ˆåœ¨core-site.xmlä¸­é…ç½®ï¼‰</td>
<td>æ— ï¼Œè¿™ä¸ªéœ€è¦åœ¨å‘½ä»¤è¡Œè¾“å…¥hadoop checknativeæŸ¥çœ‹</td>
<td>è¾“å…¥å‹ç¼©</td>
<td>Hadoopä½¿ç”¨æ–‡ä»¶æ‰©å±•ååˆ¤æ–­æ˜¯å¦æ”¯æŒæŸç§ç¼–è§£ç å™¨</td>
</tr>
<tr>
<td>mapreduce.map.output.compressï¼ˆåœ¨mapred-site.xmlä¸­é…ç½®ï¼‰</td>
<td>false</td>
<td>mapperè¾“å‡º</td>
<td>è¿™ä¸ªå‚æ•°è®¾ä¸ºtrueå¯ç”¨å‹ç¼©</td>
</tr>
<tr>
<td>mapreduce.map.output.compress.codecï¼ˆåœ¨mapred-site.xmlä¸­é…ç½®ï¼‰</td>
<td>org.apache.hadoop.io.compress.DefaultCodec</td>
<td>mapperè¾“å‡º</td>
<td>ä¼ä¸šå¤šä½¿ç”¨LZOæˆ–Snappyç¼–è§£ç å™¨åœ¨æ­¤é˜¶æ®µå‹ç¼©æ•°æ®</td>
</tr>
<tr>
<td>mapreduce.output.fileoutputformat.compressï¼ˆåœ¨mapred-site.xmlä¸­é…ç½®ï¼‰</td>
<td>false</td>
<td>reducerè¾“å‡º</td>
<td>è¿™ä¸ªå‚æ•°è®¾ä¸ºtrueå¯ç”¨å‹ç¼©</td>
</tr>
<tr>
<td>mapreduce.output.fileoutputformat.compress.codecï¼ˆåœ¨mapred-site.xmlä¸­é…ç½®ï¼‰</td>
<td>org.apache.hadoop.io.compress.DefaultCodec</td>
<td>reducerè¾“å‡º</td>
<td>ä½¿ç”¨æ ‡å‡†å·¥å…·æˆ–è€…ç¼–è§£ç å™¨ï¼Œå¦‚gzipå’Œbzip2</td>
</tr>
</tbody></table>
<h4 id="å‹ç¼©å®ä¾‹"><a href="#å‹ç¼©å®ä¾‹" class="headerlink" title="å‹ç¼©å®ä¾‹"></a>å‹ç¼©å®ä¾‹</h4><p>éƒ½åœ¨Driveré‡Œè¿›è¡Œè®¾ç½®</p>
<p>â€‹    åœ¨mapé˜¶æ®µå‹ç¼©è¦åœ¨ confåˆ›å»ºåè¿›è¡Œè®¾ç½®</p>
<p>â€‹    åœ¨reduceé˜¶æ®µå‹ç¼©è¦åœ¨è®¾ç½®è¾“å…¥è¾“å‡ºè·¯å¾„åè®¾ç½®</p>
]]></content>
      <categories>
        <category>Hadoop</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Yarn</title>
    <url>/2022/03/06/yarn/</url>
    <content><![CDATA[<h2 id="Yarn-èµ„æºè°ƒåº¦å™¨"><a href="#Yarn-èµ„æºè°ƒåº¦å™¨" class="headerlink" title="Yarn èµ„æºè°ƒåº¦å™¨"></a><strong>Yarn</strong> <strong>èµ„æºè°ƒåº¦å™¨</strong></h2><p>â€‹    Yarn æ˜¯ä¸€ä¸ªèµ„æºè°ƒåº¦å¹³å°ï¼Œè´Ÿè´£ä¸ºè¿ç®—ç¨‹åºæä¾›æœåŠ¡å™¨è¿ç®—èµ„æºï¼Œç›¸å½“äºä¸€ä¸ªåˆ†å¸ƒå¼ </p>
<p>çš„æ“ä½œç³»ç»Ÿå¹³å°ï¼Œè€Œ <font color='red'>MapReduce</font> ç­‰è¿ç®—ç¨‹åºåˆ™ç›¸å½“äºè¿è¡Œäºæ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="YARNåŸºç¡€æ¶æ„"><a href="#YARNåŸºç¡€æ¶æ„" class="headerlink" title="YARNåŸºç¡€æ¶æ„"></a>YARNåŸºç¡€æ¶æ„</h3><img src="/2022/03/06/yarn/1646531308187.png" class="" width="1646531308187">

<h2 id="Yarn-å·¥ä½œæœºåˆ¶"><a href="#Yarn-å·¥ä½œæœºåˆ¶" class="headerlink" title="Yarn å·¥ä½œæœºåˆ¶"></a>Yarn å·¥ä½œæœºåˆ¶</h2><img src="/2022/03/06/yarn/1646531545692.png" class="" width="1646531545692">

<p>ï¼ˆ1ï¼‰MR ç¨‹åºæäº¤åˆ°å®¢æˆ·ç«¯æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚ </p>
<p>ï¼ˆ2ï¼‰YarnRunner å‘ ResourceManager ç”³è¯·ä¸€ä¸ª Applicationã€‚ </p>
<p>ï¼ˆ3ï¼‰RM å°†è¯¥åº”ç”¨ç¨‹åºçš„èµ„æºè·¯å¾„è¿”å›ç»™ YarnRunnerã€‚ </p>
<p>ï¼ˆ4ï¼‰è¯¥ç¨‹åºå°†è¿è¡Œæ‰€éœ€èµ„æºæäº¤åˆ° HDFS ä¸Šã€‚ </p>
<p>ï¼ˆ5ï¼‰ç¨‹åºèµ„æºæäº¤å®Œæ¯•åï¼Œç”³è¯·è¿è¡Œ mrAppMasterã€‚ </p>
<p>ï¼ˆ6ï¼‰RM å°†ç”¨æˆ·çš„è¯·æ±‚åˆå§‹åŒ–æˆä¸€ä¸ª Taskã€‚ </p>
<p>ï¼ˆ7ï¼‰å…¶ä¸­ä¸€ä¸ª NodeManager é¢†å–åˆ° Task ä»»åŠ¡ã€‚ </p>
<p>ï¼ˆ8ï¼‰è¯¥ NodeManager åˆ›å»ºå®¹å™¨ Containerï¼Œå¹¶äº§ç”Ÿ MRAppmasterã€‚</p>
<p>ï¼ˆ9ï¼‰Container ä» HDFS ä¸Šæ‹·è´èµ„æºåˆ°æœ¬åœ°ã€‚ </p>
<p>ï¼ˆ10ï¼‰MRAppmaster å‘ RM ç”³è¯·è¿è¡Œ MapTask èµ„æºã€‚ </p>
<p>ï¼ˆ11ï¼‰RM å°†è¿è¡Œ MapTask ä»»åŠ¡åˆ†é…ç»™å¦å¤–ä¸¤ä¸ª NodeManagerï¼Œå¦ä¸¤ä¸ª NodeManager åˆ† </p>
<p>åˆ«é¢†å–ä»»åŠ¡å¹¶åˆ›å»ºå®¹å™¨ã€‚ </p>
<p>ï¼ˆ12ï¼‰MR å‘ä¸¤ä¸ªæ¥æ”¶åˆ°ä»»åŠ¡çš„ NodeManager å‘é€ç¨‹åºå¯åŠ¨è„šæœ¬ï¼Œè¿™ä¸¤ä¸ª NodeManager </p>
<p>åˆ†åˆ«å¯åŠ¨ MapTaskï¼ŒMapTask å¯¹æ•°æ®åˆ†åŒºæ’åºã€‚ </p>
<p>ï¼ˆ13ï¼‰MrAppMaster ç­‰å¾…æ‰€æœ‰ MapTask è¿è¡Œå®Œæ¯•åï¼Œå‘ RM ç”³è¯·å®¹å™¨ï¼Œè¿è¡Œ ReduceTaskã€‚ </p>
<p>ï¼ˆ14ï¼‰ReduceTask å‘ MapTask è·å–ç›¸åº”åˆ†åŒºçš„æ•°æ®ã€‚ </p>
<p>ï¼ˆ15ï¼‰ç¨‹åºè¿è¡Œå®Œæ¯•åï¼ŒMR ä¼šå‘ RM ç”³è¯·æ³¨é”€è‡ªå·±ã€‚</p>
<h3 id="ä½œä¸šæäº¤å…¨è¿‡ç¨‹"><a href="#ä½œä¸šæäº¤å…¨è¿‡ç¨‹" class="headerlink" title="ä½œä¸šæäº¤å…¨è¿‡ç¨‹"></a><strong>ä½œä¸šæäº¤å…¨è¿‡ç¨‹</strong></h3><img src="/2022/03/06/yarn/1646532204418.png" class="" width="1646532204418">

<img src="/2022/03/06/yarn/1646563347178.png" class="" width="1646563347178">

<img src="/2022/03/06/yarn/1646532229497.png" class="" width="1646532229497">

<p>ä½œä¸šæäº¤å…¨è¿‡ç¨‹è¯¦è§£ </p>
<p>ï¼ˆ1ï¼‰ä½œä¸šæäº¤ </p>
<p>ç¬¬ 1 æ­¥ï¼šClient è°ƒç”¨ job.waitForCompletion æ–¹æ³•ï¼Œå‘æ•´ä¸ªé›†ç¾¤æäº¤ MapReduce ä½œä¸šã€‚ </p>
<p>ç¬¬ 2 æ­¥ï¼šClient å‘ RM ç”³è¯·ä¸€ä¸ªä½œä¸š idã€‚ </p>
<p>ç¬¬ 3 æ­¥ï¼šRM ç»™ Client è¿”å›è¯¥ job èµ„æºçš„æäº¤è·¯å¾„å’Œä½œä¸š idã€‚ </p>
<p>ç¬¬ 4 æ­¥ï¼šClient æäº¤ jar åŒ…ã€åˆ‡ç‰‡ä¿¡æ¯å’Œé…ç½®æ–‡ä»¶åˆ°æŒ‡å®šçš„èµ„æºæäº¤è·¯å¾„ã€‚ </p>
<p>ç¬¬ 5 æ­¥ï¼šClient æäº¤å®Œèµ„æºåï¼Œå‘ RM ç”³è¯·è¿è¡Œ MrAppMasterã€‚ </p>
<p>ï¼ˆ2ï¼‰ä½œä¸šåˆå§‹åŒ– </p>
<p>ç¬¬ 6 æ­¥ï¼šå½“ RM æ”¶åˆ° Client çš„è¯·æ±‚åï¼Œå°†è¯¥ job æ·»åŠ åˆ°å®¹é‡è°ƒåº¦å™¨ä¸­ã€‚</p>
<p>ç¬¬ 7 æ­¥ï¼šæŸä¸€ä¸ªç©ºé—²çš„ NM é¢†å–åˆ°è¯¥ Jobã€‚ </p>
<p>ç¬¬ 8 æ­¥ï¼šè¯¥ NM åˆ›å»º Containerï¼Œå¹¶äº§ç”Ÿ MRAppmasterã€‚ </p>
<p>ç¬¬ 9 æ­¥ï¼šä¸‹è½½ Client æäº¤çš„èµ„æºåˆ°æœ¬åœ°ã€‚ </p>
<p>ï¼ˆ3ï¼‰ä»»åŠ¡åˆ†é… </p>
<p>ç¬¬ 10 æ­¥ï¼šMrAppMaster å‘ RM ç”³è¯·è¿è¡Œå¤šä¸ª MapTask ä»»åŠ¡èµ„æºã€‚ </p>
<p>ç¬¬ 11 æ­¥ï¼šRM å°†è¿è¡Œ MapTask ä»»åŠ¡åˆ†é…ç»™å¦å¤–ä¸¤ä¸ª NodeManagerï¼Œå¦ä¸¤ä¸ª NodeManager </p>
<p>åˆ†åˆ«é¢†å–ä»»åŠ¡å¹¶åˆ›å»ºå®¹å™¨ã€‚ </p>
<p>ï¼ˆ4ï¼‰ä»»åŠ¡è¿è¡Œ </p>
<p>ç¬¬ 12 æ­¥ï¼šMR å‘ä¸¤ä¸ªæ¥æ”¶åˆ°ä»»åŠ¡çš„ NodeManager å‘é€ç¨‹åºå¯åŠ¨è„šæœ¬ï¼Œè¿™ä¸¤ä¸ª </p>
<p>NodeManager åˆ†åˆ«å¯åŠ¨ MapTaskï¼ŒMapTask å¯¹æ•°æ®åˆ†åŒºæ’åºã€‚ </p>
<p>ç¬¬13æ­¥ï¼šMrAppMasterç­‰å¾…æ‰€æœ‰MapTaskè¿è¡Œå®Œæ¯•åï¼Œå‘RMç”³è¯·å®¹å™¨ï¼Œè¿è¡ŒReduceTaskã€‚ </p>
<p>ç¬¬ 14 æ­¥ï¼šReduceTask å‘ MapTask è·å–ç›¸åº”åˆ†åŒºçš„æ•°æ®ã€‚ </p>
<p>ç¬¬ 15 æ­¥ï¼šç¨‹åºè¿è¡Œå®Œæ¯•åï¼ŒMR ä¼šå‘ RM ç”³è¯·æ³¨é”€è‡ªå·±ã€‚ </p>
<p>ï¼ˆ5ï¼‰è¿›åº¦å’ŒçŠ¶æ€æ›´æ–° </p>
<p>â€‹    YARN ä¸­çš„ä»»åŠ¡å°†å…¶è¿›åº¦å’ŒçŠ¶æ€(åŒ…æ‹¬ counter)è¿”å›ç»™åº”ç”¨ç®¡ç†å™¨, å®¢æˆ·ç«¯æ¯ç§’(é€šè¿‡ </p>
<p>mapreduce.client.progressmonitor.pollinterval è®¾ç½®)å‘åº”ç”¨ç®¡ç†å™¨è¯·æ±‚è¿›åº¦æ›´æ–°, å±•ç¤ºç»™ç”¨æˆ·ã€‚ </p>
<p>ï¼ˆ6ï¼‰ä½œä¸šå®Œæˆ </p>
<p>â€‹    é™¤äº†å‘åº”ç”¨ç®¡ç†å™¨è¯·æ±‚ä½œä¸šè¿›åº¦å¤–, å®¢æˆ·ç«¯æ¯ 5 ç§’éƒ½ä¼šé€šè¿‡è°ƒç”¨ waitForCompletion()æ¥ </p>
<p>æ£€æŸ¥ä½œä¸šæ˜¯å¦å®Œæˆã€‚æ—¶é—´é—´éš”å¯ä»¥é€šè¿‡ mapreduce.client.completion.pollinterval æ¥è®¾ç½®ã€‚ä½œä¸š </p>
<p>å®Œæˆä¹‹å, åº”ç”¨ç®¡ç†å™¨å’Œ Container ä¼šæ¸…ç†å·¥ä½œçŠ¶æ€ã€‚ä½œä¸šçš„ä¿¡æ¯ä¼šè¢«ä½œä¸šå†å²æœåŠ¡å™¨å­˜å‚¨ </p>
<p>ä»¥å¤‡ä¹‹åç”¨æˆ·æ ¸æŸ¥ã€‚</p>
<h2 id="Yarn-è°ƒåº¦å™¨å’Œè°ƒåº¦ç®—æ³•"><a href="#Yarn-è°ƒåº¦å™¨å’Œè°ƒåº¦ç®—æ³•" class="headerlink" title="Yarn è°ƒåº¦å™¨å’Œè°ƒåº¦ç®—æ³•"></a><strong>Yarn</strong> <strong>è°ƒåº¦å™¨å’Œè°ƒåº¦ç®—æ³•</strong></h2><p>Hadoop3.1.3é»˜è®¤çš„ä½¿ç”¨çš„è°ƒåº¦å™¨æ˜¯Capacity Schedulerï¼ˆå®¹é‡ï¼‰ã€‚</p>
<h4 id="å…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼ˆFIFOï¼‰"><a href="#å…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼ˆFIFOï¼‰" class="headerlink" title="å…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼ˆFIFOï¼‰"></a>å…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼ˆFIFOï¼‰</h4><img src="/2022/03/06/yarn/1646532413816.png" class="" width="1646532413816">

<p><strong>ä¼˜ç‚¹ï¼šç®€å•æ˜“æ‡‚ï¼›</strong> </p>
<p><strong>ç¼ºç‚¹ï¼šä¸æ”¯æŒå¤šé˜Ÿåˆ—ï¼Œç”Ÿäº§ç¯å¢ƒå¾ˆå°‘ä½¿ç”¨ï¼›</strong></p>
<h4 id="å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity-Schedulerï¼‰"><a href="#å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity-Schedulerï¼‰" class="headerlink" title="å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity Schedulerï¼‰"></a>å®¹é‡è°ƒåº¦å™¨ï¼ˆCapacity Schedulerï¼‰</h4><p><img src="/yarn/1646532503851.png" alt="1646532503851"><img src="/yarn/1646532509897.png" alt="1646532509897"></p>
<h4 id="å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair-Schedulerï¼‰"><a href="#å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair-Schedulerï¼‰" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair Schedulerï¼‰"></a>å…¬å¹³è°ƒåº¦å™¨ï¼ˆFair Schedulerï¼‰</h4><img src="/2022/03/06/yarn/1646533027061.png" class="" width="1646533027061">

<img src="/2022/03/06/yarn/1646563372019.png" class="" width="1646533129528">

<h4 id="å…¬å¹³è°ƒåº¦å™¨èµ„æºåˆ†é…ç®—æ³•"><a href="#å…¬å¹³è°ƒåº¦å™¨èµ„æºåˆ†é…ç®—æ³•" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨èµ„æºåˆ†é…ç®—æ³•"></a><strong>å…¬å¹³è°ƒåº¦å™¨èµ„æºåˆ†é…ç®—æ³•</strong></h4><h4 id="å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—èµ„æºåˆ†é…æ–¹å¼"><a href="#å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—èµ„æºåˆ†é…æ–¹å¼" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—èµ„æºåˆ†é…æ–¹å¼"></a><img src="/yarn/1646533266234.png" alt="1646533266234"><strong>å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—èµ„æºåˆ†é…æ–¹å¼</strong><img src="/yarn/1646533387333.png" alt="1646533387333"></h4><p>3ï¼‰DRFç­–ç•¥ </p>
<p>3ï¼‰DRFç­–ç•¥<br>    DRFï¼ˆDominant Resource Fairnessï¼‰ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´çš„èµ„æºï¼Œéƒ½æ˜¯å•ä¸€æ ‡å‡†ï¼Œä¾‹å¦‚åªè€ƒè™‘å†…å­˜ï¼ˆä¹Ÿæ˜¯Yarné»˜<br>è®¤çš„æƒ…å†µï¼‰ã€‚ä½†æ˜¯å¾ˆå¤šæ—¶å€™æˆ‘ä»¬èµ„æºæœ‰å¾ˆå¤šç§ï¼Œä¾‹å¦‚å†…å­˜ï¼ŒCPUï¼Œç½‘ç»œå¸¦å®½ç­‰ï¼Œè¿™æ ·æˆ‘ä»¬å¾ˆéš¾è¡¡é‡ä¸¤ä¸ªåº”ç”¨<br>åº”è¯¥åˆ†é…çš„èµ„æºæ¯”ä¾‹ã€‚<br>    é‚£ä¹ˆåœ¨YARNä¸­ï¼Œæˆ‘ä»¬ç”¨DRFæ¥å†³å®šå¦‚ä½•è°ƒåº¦ï¼š<br>    å‡è®¾é›†ç¾¤ä¸€å…±æœ‰100 CPUå’Œ10T å†…å­˜ï¼Œè€Œåº”ç”¨Aéœ€è¦ï¼ˆ2 CPU, 300GBï¼‰ï¼Œåº”ç”¨Béœ€è¦ï¼ˆ6 CPUï¼Œ100GBï¼‰ã€‚<br>åˆ™ä¸¤ä¸ªåº”ç”¨åˆ†åˆ«éœ€è¦Aï¼ˆ2%CPU, 3%å†…å­˜ï¼‰å’ŒBï¼ˆ6%CPU, 1%å†…å­˜ï¼‰çš„èµ„æºï¼Œè¿™å°±æ„å‘³ç€Aæ˜¯å†…å­˜ä¸»å¯¼çš„, Bæ˜¯<br>CPUä¸»å¯¼çš„ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©DRFç­–ç•¥å¯¹ä¸åŒåº”ç”¨è¿›è¡Œä¸åŒèµ„æºï¼ˆCPUå’Œå†…å­˜ï¼‰çš„ä¸€ä¸ªä¸åŒæ¯”<br>ä¾‹çš„é™åˆ¶</p>
<h3 id="Yarn-ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒå‚æ•°"><a href="#Yarn-ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒå‚æ•°" class="headerlink" title="Yarn ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒå‚æ•°"></a>Yarn ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒå‚æ•°</h3><img src="/2022/03/06/yarn/1646534533223.png" class="" width="1646534533223">

<h3 id="å®¹é‡è°ƒåº¦å™¨å¤šé˜Ÿåˆ—æäº¤æ¡ˆä¾‹"><a href="#å®¹é‡è°ƒåº¦å™¨å¤šé˜Ÿåˆ—æäº¤æ¡ˆä¾‹" class="headerlink" title="å®¹é‡è°ƒåº¦å™¨å¤šé˜Ÿåˆ—æäº¤æ¡ˆä¾‹"></a><strong>å®¹é‡è°ƒåº¦å™¨å¤šé˜Ÿåˆ—æäº¤æ¡ˆä¾‹</strong></h3><p>1ï¼‰åœ¨ç”Ÿäº§ç¯å¢ƒæ€ä¹ˆåˆ›å»ºé˜Ÿåˆ—ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰è°ƒåº¦å™¨é»˜è®¤å°±1ä¸ªdefaulté˜Ÿåˆ—ï¼Œä¸èƒ½æ»¡è¶³ç”Ÿäº§è¦æ±‚ã€‚</p>
<p>ï¼ˆ2ï¼‰æŒ‰ç…§æ¡†æ¶ï¼šhive &#x2F;spark&#x2F; flink æ¯ä¸ªæ¡†æ¶çš„ä»»åŠ¡æ”¾å…¥æŒ‡å®šçš„é˜Ÿåˆ—ï¼ˆä¼ä¸šç”¨çš„ä¸æ˜¯ç‰¹åˆ«å¤šï¼‰</p>
<p>ï¼ˆ3ï¼‰æŒ‰ç…§ä¸šåŠ¡æ¨¡å—ï¼šç™»å½•æ³¨å†Œã€è´­ç‰©è½¦ã€ä¸‹å•ã€ä¸šåŠ¡éƒ¨é—¨1ã€ä¸šåŠ¡éƒ¨é—¨2</p>
<p>2ï¼‰åˆ›å»ºå¤šé˜Ÿåˆ—çš„å¥½å¤„ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰å› ä¸ºæ‹…å¿ƒå‘˜å·¥ä¸å°å¿ƒï¼Œå†™é€’å½’æ­»å¾ªç¯ä»£ç ï¼ŒæŠŠæ‰€æœ‰èµ„æºå…¨éƒ¨è€—å°½ã€‚</p>
<p>ï¼ˆ2ï¼‰å®ç°ä»»åŠ¡çš„<strong>é™çº§</strong>ä½¿ç”¨ï¼Œç‰¹æ®Šæ—¶æœŸä¿è¯é‡è¦çš„ä»»åŠ¡é˜Ÿåˆ—èµ„æºå……è¶³ã€‚11.11 6.18</p>
<p>ä¸šåŠ¡éƒ¨é—¨1ï¼ˆé‡è¦ï¼‰&#x3D;ã€‹ä¸šåŠ¡éƒ¨é—¨2ï¼ˆæ¯”è¾ƒé‡è¦ï¼‰&#x3D;ã€‹ä¸‹å•ï¼ˆä¸€èˆ¬ï¼‰&#x3D;ã€‹è´­ç‰©è½¦ï¼ˆä¸€èˆ¬ï¼‰&#x3D;ã€‹ç™»å½•æ³¨å†Œï¼ˆæ¬¡è¦ï¼‰</p>
<p><strong>é‡å¯Yarnæˆ–è€…æ‰§è¡Œyarn rmadmin -refreshQueuesåˆ·æ–°é˜Ÿåˆ—ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸¤æ¡é˜Ÿåˆ—ï¼š</strong></p>
<p><code>yarn rmadmin -refreshQueues</code></p>
<p><strong>æäº¤é˜Ÿä¼çš„æ–¹å¼</strong></p>
<p>1ï¼‰hadoop jarçš„æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-3.1.3]$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount -D mapreduce.job.queuename=hive /input /output</span><br></pre></td></tr></table></figure>

<p><font color='red'>-D mapreduce.job.queuename&#x3D;hive</font></p>
<p>2ï¼‰æ‰“jaråŒ…çš„æ–¹å¼</p>
<p>é»˜è®¤çš„ä»»åŠ¡æäº¤éƒ½æ˜¯æäº¤åˆ°defaulté˜Ÿåˆ—çš„ã€‚å¦‚æœå¸Œæœ›å‘å…¶ä»–é˜Ÿåˆ—æäº¤ä»»åŠ¡ï¼Œéœ€è¦åœ¨Driverä¸­å£°æ˜ï¼š.</p>
<img src="/2022/03/06/yarn/1646538048009.png" class="" width="1646538048009">

<h3 id="ä»»åŠ¡ä¼˜å…ˆçº§"><a href="#ä»»åŠ¡ä¼˜å…ˆçº§" class="headerlink" title="ä»»åŠ¡ä¼˜å…ˆçº§"></a>ä»»åŠ¡ä¼˜å…ˆçº§</h3><p>â€‹    å®¹é‡è°ƒåº¦å™¨ï¼Œæ”¯æŒä»»åŠ¡ä¼˜å…ˆçº§çš„é…ç½®ï¼Œåœ¨èµ„æºç´§å¼ æ—¶ï¼Œä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡å°†ä¼˜å…ˆè·å–èµ„æºã€‚é»˜è®¤æƒ…å†µï¼ŒYarnå°†æ‰€æœ‰ä»»åŠ¡çš„ä¼˜å…ˆçº§é™åˆ¶ä¸º0ï¼Œè‹¥æƒ³ä½¿ç”¨ä»»åŠ¡çš„ä¼˜å…ˆçº§åŠŸèƒ½ï¼Œé¡»å¼€æ”¾è¯¥é™åˆ¶ã€‚</p>
<p>1ï¼‰ä¿®æ”¹yarn-site.xmlæ–‡ä»¶ï¼Œå¢åŠ ä»¥ä¸‹å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.cluster.max-application-priority&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;5&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<p>2ï¼‰åˆ†å‘é…ç½®ï¼Œå¹¶é‡å¯Yarn</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> xsync yarn-site.xml</span><br><span class="line">[ hadoop-3.1.3]$ sbin/stop-yarn.sh</span><br><span class="line">[ hadoop-3.1.3]$ sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>

<p>3ï¼‰æ¨¡æ‹Ÿèµ„æºç´§å¼ ç¯å¢ƒï¼Œå¯è¿ç»­æäº¤ä»¥ä¸‹ä»»åŠ¡ï¼Œç›´åˆ°æ–°æäº¤çš„ä»»åŠ¡ç”³è¯·ä¸åˆ°èµ„æºä¸ºæ­¢ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[hadoop-3.1.3]$hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi 5 2000000</span><br></pre></td></tr></table></figure>

<img src="/2022/03/06/yarn/1646538180009.png" class="" width="1646538180009">

<p>4ï¼‰å†æ¬¡é‡æ–°æäº¤ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[hadoop-3.1.3]$hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi  -D mapreduce.job.priority=5 5 2000000</span><br></pre></td></tr></table></figure>

<img src="/2022/03/06/yarn/1646538197679.png" class="" width="1646538197679">

<p>5ï¼‰ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡çš„ä¼˜å…ˆçº§ã€‚</p>
<p><code>yarn application -appID &lt;ApplicationID&gt; -updatePriority ä¼˜å…ˆçº§</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[hadoop-3.1.3]$ yarn application -appID application_1611133087930_0009 -updatePriority 5</span><br></pre></td></tr></table></figure>

<h3 id="å…¬å¹³è°ƒåº¦å™¨æ¡ˆä¾‹"><a href="#å…¬å¹³è°ƒåº¦å™¨æ¡ˆä¾‹" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨æ¡ˆä¾‹"></a>å…¬å¹³è°ƒåº¦å™¨æ¡ˆä¾‹</h3><p>â€‹    åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ—ï¼Œåˆ†åˆ«æ˜¯ test å’Œ atguiguï¼ˆä»¥ç”¨æˆ·æ‰€å±ç»„å‘½åï¼‰ã€‚æœŸæœ›å®ç°ä»¥ä¸‹æ•ˆæœï¼šè‹¥ç”¨æˆ·æäº¤ä»»åŠ¡æ—¶æŒ‡å®šé˜Ÿåˆ—ï¼Œåˆ™ä»»åŠ¡æäº¤åˆ°æŒ‡å®šé˜Ÿåˆ—è¿è¡Œï¼›è‹¥æœªæŒ‡å®šé˜Ÿåˆ—ï¼Œtes tç”¨æˆ·æäº¤çš„ä»»åŠ¡åˆ° root.group.test é˜Ÿåˆ—è¿è¡Œï¼Œatguigu æäº¤çš„ä»»åŠ¡åˆ° root.group.atguigu é˜Ÿåˆ—è¿è¡Œï¼ˆæ³¨ï¼šgroupä¸ºç”¨æˆ·æ‰€å±ç»„ï¼‰ã€‚<br>â€‹    å…¬å¹³è°ƒåº¦å™¨çš„é…ç½®æ¶‰åŠåˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ yarn-site.xmlï¼Œå¦ä¸€ä¸ªæ˜¯å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—åˆ†é…æ–‡ä»¶fair-scheduler.xmlï¼ˆæ–‡ä»¶åå¯è‡ªå®šä¹‰ï¼‰ã€‚</p>
<p>1ï¼‰ä¿®æ”¹yarn-site.xmlæ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹å‚æ•°</p>
<blockquote>
<property>
    <name>yarn.resourcemanager.scheduler.class</name>
    <value>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler</value>
    <description>é…ç½®ä½¿ç”¨å…¬å¹³è°ƒåº¦å™¨</description>
</property>

<property>
   <name>yarn.scheduler.fair.allocation.file</name>
    <value>/opt/module/hadoop-3.1.3/etc/hadoop/fair-scheduler.xml</value>
    <description>æŒ‡æ˜å…¬å¹³è°ƒåº¦å™¨é˜Ÿåˆ—åˆ†é…é…ç½®æ–‡ä»¶</description>
</property>

<property>
    <name>yarn.scheduler.fair.preemption</name>
    <value>false</value>
    <description>ç¦æ­¢é˜Ÿåˆ—é—´èµ„æºæŠ¢å </description>
</property>
</blockquote>
<p>2ï¼‰é…ç½®fair-scheduler.xml</p>
<blockquote>
<?xml version="1.0"?>
<allocations>
  <!-- å•ä¸ªé˜Ÿåˆ—ä¸­Application Masterå ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹,å–å€¼0-1 ï¼Œä¼ä¸šä¸€èˆ¬é…ç½®0.1 -->
  <queueMaxAMShareDefault>0.5</queueMaxAMShareDefault>
  <!-- å•ä¸ªé˜Ÿåˆ—æœ€å¤§èµ„æºçš„é»˜è®¤å€¼ test atguigu default -->
  <queueMaxResourcesDefault>4096mb,4vcores</queueMaxResourcesDefault>

  <!-- å¢åŠ ä¸€ä¸ªé˜Ÿåˆ—test -->
  <queue name="test">
    <!-- é˜Ÿåˆ—æœ€å°èµ„æº -->
    <minResources>2048mb,2vcores</minResources>
    <!-- é˜Ÿåˆ—æœ€å¤§èµ„æº -->
    <maxResources>4096mb,4vcores</maxResources>
    <!-- é˜Ÿåˆ—ä¸­æœ€å¤šåŒæ—¶è¿è¡Œçš„åº”ç”¨æ•°ï¼Œé»˜è®¤50ï¼Œæ ¹æ®çº¿ç¨‹æ•°é…ç½® -->
    <maxRunningApps>4</maxRunningApps>
    <!-- é˜Ÿåˆ—ä¸­Application Masterå ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹ -->
    <maxAMShare>0.5</maxAMShare>
    <!-- è¯¥é˜Ÿåˆ—èµ„æºæƒé‡,é»˜è®¤å€¼ä¸º1.0 -->
    <weight>1.0</weight>
    <!-- é˜Ÿåˆ—å†…éƒ¨çš„èµ„æºåˆ†é…ç­–ç•¥ -->
    <schedulingPolicy>fair</schedulingPolicy>
  </queue>
  <!-- å¢åŠ ä¸€ä¸ªé˜Ÿåˆ—atguigu -->
  <queue name="atguigu" type="parent">
    <!-- é˜Ÿåˆ—æœ€å°èµ„æº -->
    <minResources>2048mb,2vcores</minResources>
    <!-- é˜Ÿåˆ—æœ€å¤§èµ„æº -->
    <maxResources>4096mb,4vcores</maxResources>
    <!-- é˜Ÿåˆ—ä¸­æœ€å¤šåŒæ—¶è¿è¡Œçš„åº”ç”¨æ•°ï¼Œé»˜è®¤50ï¼Œæ ¹æ®çº¿ç¨‹æ•°é…ç½® -->
    <maxRunningApps>4</maxRunningApps>
    <!-- é˜Ÿåˆ—ä¸­Application Masterå ç”¨èµ„æºçš„æœ€å¤§æ¯”ä¾‹ -->
    <maxAMShare>0.5</maxAMShare>
    <!-- è¯¥é˜Ÿåˆ—èµ„æºæƒé‡,é»˜è®¤å€¼ä¸º1.0 -->
    <weight>1.0</weight>
    <!-- é˜Ÿåˆ—å†…éƒ¨çš„èµ„æºåˆ†é…ç­–ç•¥ -->
    <schedulingPolicy>fair</schedulingPolicy>
  </queue>

  <!-- ä»»åŠ¡é˜Ÿåˆ—åˆ†é…ç­–ç•¥,å¯é…ç½®å¤šå±‚è§„åˆ™,ä»ç¬¬ä¸€ä¸ªè§„åˆ™å¼€å§‹åŒ¹é…,ç›´åˆ°åŒ¹é…æˆåŠŸ -->
  <queuePlacementPolicy>
    <!-- æäº¤ä»»åŠ¡æ—¶æŒ‡å®šé˜Ÿåˆ—,å¦‚æœªæŒ‡å®šæäº¤é˜Ÿåˆ—,åˆ™ç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ªè§„åˆ™; falseè¡¨ç¤ºï¼šå¦‚æœæŒ‡å®šé˜Ÿåˆ—ä¸å­˜åœ¨,ä¸å…è®¸è‡ªåŠ¨åˆ›å»º-->
    <rule name="specified" create="false"/>
    <!-- æäº¤åˆ°root.group.usernameé˜Ÿåˆ—,è‹¥root.groupä¸å­˜åœ¨,ä¸å…è®¸è‡ªåŠ¨åˆ›å»ºï¼›è‹¥root.group.userä¸å­˜åœ¨,å…è®¸è‡ªåŠ¨åˆ›å»º -->
    <rule name="nestedUserQueue" create="true">
        <rule name="primaryGroup" create="false"/>
    </rule>
    <!-- æœ€åä¸€ä¸ªè§„åˆ™å¿…é¡»ä¸ºrejectæˆ–è€…defaultã€‚Rejectè¡¨ç¤ºæ‹’ç»åˆ›å»ºæäº¤å¤±è´¥ï¼Œdefaultè¡¨ç¤ºæŠŠä»»åŠ¡æäº¤åˆ°defaulté˜Ÿåˆ— -->
    <rule name="reject" />
  </queuePlacementPolicy>
</allocations>
</blockquote>
<p>3ï¼‰åˆ†å‘é…ç½®å¹¶é‡å¯Yarn</p>
<h2 id="Yarnçš„Toolæ¥å£æ¡ˆä¾‹"><a href="#Yarnçš„Toolæ¥å£æ¡ˆä¾‹" class="headerlink" title="Yarnçš„Toolæ¥å£æ¡ˆä¾‹"></a>Yarnçš„Toolæ¥å£æ¡ˆä¾‹</h2><p>0ï¼‰å›é¡¾ï¼š</p>
<p>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop jar wc.jar com.atguigu.mapreduce.<font color='red'>wordcount2</font>.WordCountDriver &#x2F;input &#x2F;output1</p>
<p>æœŸæœ›å¯ä»¥åŠ¨æ€ä¼ å‚ï¼Œç»“æœæŠ¥é”™ï¼Œè¯¯è®¤ä¸ºæ˜¯ç¬¬ä¸€ä¸ªè¾“å…¥å‚æ•°ã€‚</p>
<p>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop jar wc.jar com.atguigu.mapreduce.<font color='red'>wordcount2</font>.WordCountDriver <font color='red'>-Dmapreduce.job.queuename&#x3D;root.test</font> &#x2F;input &#x2F;output1</p>
<p>1ï¼‰éœ€æ±‚ï¼šè‡ªå·±å†™çš„ç¨‹åºä¹Ÿå¯ä»¥åŠ¨æ€ä¿®æ”¹å‚æ•°ã€‚ç¼–å†™Yarnçš„Toolæ¥å£ã€‚</p>
<p>2ï¼‰å…·ä½“æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰åˆ›å»ºç±»WordCountå¹¶å®ç°Toolæ¥å£ï¼š</p>
<p>â€‹        é‡Œé¢æœ‰ä¸‰ä¸ªæ–¹æ³•åˆ†åˆ«æ˜¯ runï¼ˆï¼‰  setConfï¼ˆï¼‰ getConfï¼ˆï¼‰ åœ¨runé‡Œé¢å®ç°Driveré‡Œé¢çš„7æ­¥</p>
<p>â€‹        Mapperç±»å’ŒReducerç±» åˆ›å»ºä¸ºå†…éƒ¨ç±»ï¼Œå†…å®¹ä¸€æ ·</p>
<p>ï¼ˆ4ï¼‰æ–°å»ºWordCountDriver</p>
<p>â€‹    åœ¨é‡Œé¢è·å– conf  åˆ¤æ–­æ˜¯å¦æœ‰Toolæ¥å£</p>
<p>  &#x2F;&#x2F; 1. åˆ›å»ºé…ç½®æ–‡ä»¶<br>        Configuration conf &#x3D; new Configuration();</p>
<pre><code>    // 2. åˆ¤æ–­æ˜¯å¦æœ‰toolæ¥å£
    switch (args[0])&#123;
        case &quot;wordcount&quot;:
            tool = new WordCount();
            break;
        default:
            throw new RuntimeException(&quot; No such tool: &quot;+ args[0] );
    &#125;
    // 3. ç”¨Toolæ‰§è¡Œç¨‹åº
    // Arrays.copyOfRange å°†è€æ•°ç»„çš„å…ƒç´ æ”¾åˆ°æ–°æ•°ç»„é‡Œé¢
    int run = ToolRunner.run(conf, tool, Arrays.copyOfRange(args, 1, args.length));

    System.exit(run);
</code></pre>
<p>åœ¨hadoopä¸Šè¿è¡Œæ—¶è¦åŠ ä¸Šç‰¹å®šçš„Toolæ¥å£</p>
<p>[atguigu@hadoop102 hadoop-3.1.3]$ yarn jar YarnDemo.jar com.atguigu.yarn.WordCountDriver  <font color='red'>wordcount</font>  &#x2F;input &#x2F;output </p>
<p>æ³¨æ„æ­¤æ—¶æäº¤çš„3ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªç”¨äºç”Ÿæˆç‰¹å®šçš„Toolï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªä¸ºè¾“å…¥è¾“å‡ºç›®å½•ã€‚æ­¤æ—¶å¦‚æœæˆ‘ä»¬å¸Œæœ›åŠ å…¥è®¾ç½®å‚æ•°ï¼Œå¯ä»¥åœ¨wordcountåé¢æ·»åŠ å‚æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<p>[atguigu@hadoop102 hadoop-3.1.3]$ yarn jar YarnDemo.jar com.atguigu.yarn.WordCountDriver  <font color='red'>wordcount -Dmapreduce.job.queuename&#x3D;root.test</font>  &#x2F;input &#x2F;output1</p>
<h2 id="Yarné‡ç‚¹"><a href="#Yarné‡ç‚¹" class="headerlink" title="Yarné‡ç‚¹"></a>Yarné‡ç‚¹</h2><h3 id="1-Yarnçš„å·¥ä½œæœºåˆ¶"><a href="#1-Yarnçš„å·¥ä½œæœºåˆ¶" class="headerlink" title="1.Yarnçš„å·¥ä½œæœºåˆ¶"></a>1.Yarnçš„å·¥ä½œæœºåˆ¶</h3><h3 id="2-Yarnçš„è°ƒåº¦å™¨"><a href="#2-Yarnçš„è°ƒåº¦å™¨" class="headerlink" title="2.Yarnçš„è°ƒåº¦å™¨"></a>2.Yarnçš„è°ƒåº¦å™¨</h3><p>â€‹    1ï¼‰FIFO&#x2F;å®¹é‡&#x2F;å…¬å¹³</p>
<p>â€‹    2ï¼‰apache é»˜è®¤è°ƒåº¦å™¨æ˜¯å®¹é‡   å®¹é‡ï¼š CDHé»˜è®¤è°ƒåº¦å™¨  å…¬å¹³</p>
<p>â€‹    3ï¼‰å…¬å¹³&#x2F;å®¹é‡ é»˜è®¤ä¸€ä¸ªdefaultï¼Œéœ€è¦åˆ›å»ºå¤šé˜Ÿåˆ—</p>
<p>â€‹    4ï¼‰ä¸­å°ä¼ä¸šï¼šhive   spark  flink  mr</p>
<p>â€‹    5ï¼‰ä¸­å¤§ä¼ä¸šï¼šä¸šåŠ¡æ¨¡å— ï¼šç™»å½•&#x2F;æ³¨å†Œ&#x2F;è´­ç‰©è½¦&#x2F;è¥é”€</p>
<p>â€‹    6ï¼‰å¥½å¤„ï¼šè§£è€¦  é™ä½é£é™© é™çº§ä½¿ç”¨</p>
<p>â€‹    7ï¼‰æ¯ä¸ªè°ƒåº¦å™¨ç‰¹ç‚¹</p>
<p>â€‹            ç›¸åŒç‚¹ï¼šæ”¯æŒå¤šé˜Ÿåˆ—ï¼Œå¯ä»¥å€Ÿèµ„æºï¼Œæ”¯æŒå¤šç”¨æˆ·</p>
<p>â€‹            ä¸åŒç‚¹ï¼šå®¹é‡ï¼šä¼˜å…ˆæ»¡è¶³å…ˆè¿›æ¥çš„ä»»åŠ¡</p>
<p>â€‹                            å…¬å¹³ï¼šå…¬å¹³ï¼Œåœ¨é˜Ÿåˆ—é‡Œé¢å…¬å¹³äº«æœ‰é˜Ÿåˆ—èµ„æº</p>
<p>â€‹    8ï¼‰æ€ä¹ˆé€‰ï¼š</p>
<p>â€‹                ä¸­å°ä¼ä¸šï¼šå¯¹å¹¶å‘åº¦è¦æ±‚ä¸é«˜ï¼Œé€‰å®¹é‡</p>
<p>â€‹                ä¸­å¤§ä¼ä¸šï¼šå¯¹å¹¶å‘åº¦æ¯”è¾ƒé«˜ï¼Œé€‰å…¬å¹³</p>
<h3 id="3-å¼€å‘éœ€è¦é‡ç‚¹æŒæ¡"><a href="#3-å¼€å‘éœ€è¦é‡ç‚¹æŒæ¡" class="headerlink" title="3.å¼€å‘éœ€è¦é‡ç‚¹æŒæ¡"></a>3.å¼€å‘éœ€è¦é‡ç‚¹æŒæ¡</h3><p>1ï¼‰è°ƒåº¦ç®—æ³•</p>
<p>2ï¼‰Yarnå¸¸ç”¨å‘½ä»¤ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼ŒAPPâ€¦çš„è¿è¡Œï¼ŒæŸ¥çœ‹å®¹å™¨ï¼‰</p>
<p>3ï¼‰æ ¸å¿ƒå‚æ•°çš„é…ç½®</p>
<p>4ï¼‰é…ç½®å®¹é‡è°ƒåº¦å™¨å’Œå…¬å¹³è°ƒåº¦å™¨</p>
<p>5ï¼‰Toolæ¥å£ä½¿ç”¨</p>
]]></content>
      <categories>
        <category>Hadoop</category>
      </categories>
      <tags>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLåŸºç¡€</title>
    <url>/2022/03/09/SQL%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="MYSQLå‡½æ•°"><a href="#MYSQLå‡½æ•°" class="headerlink" title="MYSQLå‡½æ•°"></a>MYSQLå‡½æ•°</h1><p><code>select å‡½æ•°åï¼ˆï¼‰ from è¡¨ </code></p>
<h2 id="å•è¡Œå‡½æ•°ï¼š"><a href="#å•è¡Œå‡½æ•°ï¼š" class="headerlink" title="å•è¡Œå‡½æ•°ï¼š"></a><strong>å•è¡Œå‡½æ•°ï¼š</strong></h2><h3 id="å­—ç¬¦å‡½æ•°ï¼š"><a href="#å­—ç¬¦å‡½æ•°ï¼š" class="headerlink" title="å­—ç¬¦å‡½æ•°ï¼š"></a>å­—ç¬¦å‡½æ•°ï¼š</h3><ul>
<li>lengthï¼ˆstrï¼‰ï¼šè¿”å›å‚æ•°å€¼çš„å­—èŠ‚ä¸ªæ•°</li>
<li>concatï¼ˆstr1ï¼Œâ€˜-â€˜ï¼Œstr2ï¼‰ï¼š æ‹¼æ¥å­—ç¬¦ä¸²</li>
<li>upperï¼šè½¬å¤§å†™</li>
<li>lowerï¼šè½¬å°å†™</li>
<li>substrï¼ˆstrï¼Œnum1,num2ï¼‰ï¼ˆstrï¼Œnumï¼‰ï¼šæˆªå–å­—ç¬¦ä¸²</li>
<li>instrï¼ˆstr1ï¼Œstr2ï¼‰ï¼šè¿”å›str2åœ¨str1é‡Œçš„èµ·å§‹ç´¢å¼•ï¼Œæ‰¾ä¸åˆ°è¿”å›0</li>
<li>trimï¼ˆstrï¼‰ï¼ˆc from strï¼‰ï¼šå»å‰åç©ºæ ¼ï¼ˆcï¼‰</li>
<li>lpadï¼ˆstrï¼Œnumï¼Œcï¼‰ï¼šç”¨æŒ‡å®šçš„å­—ç¬¦å®ç°<font color='red'>å·¦</font>å¡«å……æŒ‡å®šé•¿åº¦</li>
<li>rpadï¼ˆstrï¼Œnumï¼Œcï¼‰ï¼šç”¨æŒ‡å®šçš„å­—ç¬¦å®ç°<font color='red'>å³</font>å¡«å……æŒ‡å®šé•¿åº¦</li>
<li>replaceï¼ˆstr1ï¼Œstr2ï¼Œstr3ï¼‰ï¼šç”¨str3æ›¿æ¢str1é‡Œé¢å­˜åœ¨çš„str2å­—ç¬¦ä¸²</li>
</ul>
<h3 id="æ•°å­¦å‡½æ•°ï¼š"><a href="#æ•°å­¦å‡½æ•°ï¼š" class="headerlink" title="æ•°å­¦å‡½æ•°ï¼š"></a>æ•°å­¦å‡½æ•°ï¼š</h3><ul>
<li>roundï¼ˆnumï¼Œxï¼‰ï¼šå››èˆäº”å…¥ä¿ç•™xä½å°æ•°</li>
<li>ceilï¼ˆnumï¼‰ï¼šå‘ä¸Šå–æ•´ï¼Œè¿”å›&gt;&#x3D;numçš„æœ€å°æ•´æ•° ï¼Œ1.0001ä¹Ÿæ˜¯2</li>
<li>floorï¼ˆnumï¼‰:å‘ä¸‹å–æ•´</li>
<li>truncateï¼ˆnumï¼Œxï¼‰ï¼šæˆªæ–­ï¼Œå°æ•°åä¿ç•™xä½</li>
<li>modï¼ˆnumï¼Œxï¼‰ï¼šå–ä½™   ç›¸å½“äº  %    num%x</li>
</ul>
<h3 id="æ—¥æœŸå‡½æ•°ï¼š"><a href="#æ—¥æœŸå‡½æ•°ï¼š" class="headerlink" title="æ—¥æœŸå‡½æ•°ï¼š"></a>æ—¥æœŸå‡½æ•°ï¼š</h3><ul>
<li><p>nowï¼ˆï¼‰ï¼šè¿”å›å½“å‰æ—¶é—´ åŒ…æ‹¬æ—¶é—´</p>
</li>
<li><p>curdateï¼ˆï¼‰ï¼šè¿”å›æ—¥æœŸä¸åŒ…å«æ—¶é—´</p>
</li>
<li><p>curtimeï¼ˆï¼‰ï¼šè¿”å›æ—¶é—´ï¼Œä¸åŒ…æ‹¬æ—¥æœŸ</p>
</li>
<li><p>yearï¼ˆnowï¼ˆï¼‰ï¼‰ï¼šè¿”å›å¹´ã€‚ æœˆï¼ˆmonthã€monthnameï¼ˆæœˆåå­—ï¼‰ï¼‰ï¼‰ æ—¥   å°æ—¶  åˆ†é’Ÿ  ç§’ä¸€æ ·</p>
</li>
<li><p>str_to_date:å°†æ—¥æœŸæ ¼å¼çš„å­—ç¬¦è½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼ ã€‚ <font color='green'>str_to_date(â€˜9-13-1993â€™,â€™%m-%d-%Yâ€™); â€”-  1993-09-13</font></p>
<img src="/2022/03/09/SQL%E5%9F%BA%E7%A1%80/1646827945093.png" class="" width="1646827945093">


</li>
<li><p>date_format:å°†æ—¥æœŸè½¬æ¢ä¸ºå­—ç¬¦ä¸²     <font color='green'>date_format(now(),â€™%yå¹´%æ¯æœˆ%dæ—¥â€™)ï¼›   22å¹´09æœˆ09æ—¥</font>å…¶ä»–å‡½æ•°ï¼š</p>
</li>
<li><p>version():æŸ¥çœ‹ç‰ˆæœ¬å·</p>
</li>
<li><p>databaseï¼ˆï¼‰ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“</p>
</li>
<li><p>userï¼ˆï¼‰ï¼šæŸ¥çœ‹å½“å‰ç”¨æˆ·</p>
</li>
</ul>
<h3 id="æµç¨‹æ§åˆ¶å‡½æ•°ï¼š"><a href="#æµç¨‹æ§åˆ¶å‡½æ•°ï¼š" class="headerlink" title="æµç¨‹æ§åˆ¶å‡½æ•°ï¼š"></a>æµç¨‹æ§åˆ¶å‡½æ•°ï¼š</h3><ul>
<li><p>ifå‡½æ•°ï¼šif   else    çš„æ•ˆæœ</p>
<p><font color='green'>select if ï¼ˆ10 &gt; 5Â  ,â€™daâ€™,â€™xiaoâ€™);     da</font>\</p>
</li>
<li><p>caseå‡½æ•°     <font color='green'>select  åŸå§‹å·¥èµ„ï¼Œdep_idï¼Œcase dep_id when 30 then salary * 1.1 when 40 then salary*1.2 else salary end as æ–°å·¥èµ„ from empï¼›</font></p>
</li>
</ul>
<h2 id="åˆ†ç»„å‡½æ•°ï¼š"><a href="#åˆ†ç»„å‡½æ•°ï¼š" class="headerlink" title="åˆ†ç»„å‡½æ•°ï¼š"></a>åˆ†ç»„å‡½æ•°ï¼š</h2><p>ç”¨åšç»Ÿè®¡ä½¿ç”¨ï¼Œåˆç§°èšåˆå‡½æ•°æˆ–ç»„å‡½æ•°</p>
<p>æœ‰  <font color='green'> sum  avg  count max  min </font>ã€‚</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>sumï¼Œavgä¸€èˆ¬ç”¨äºå¤„ç†æ•°å€¼å‡½æ•°</li>
<li>max ï¼Œminï¼Œcount å¯ ç”¨äºä»»ä½•å‡½æ•°</li>
<li>æ‰€æœ‰åˆ†ç»„å‡½æ•°éƒ½å¿½ç•¥nullå€¼</li>
<li>å¯ä»¥å’Œdistinctï¼ˆå»é‡ï¼‰æ­é…ï¼š<ul>
<li><font color='green'>select sum(distinct salary) ,sum(salary) from emp;    39666    1520</font></li>
</ul>
</li>
<li>countå‡½æ•°çš„è¯¦ç»†ä»‹ç»<ul>
<li>count(*) æŸ¥è¯¢æ€»è¡Œæ•°  countï¼ˆå¸¸é‡ï¼‰ ä¹Ÿæ˜¯ç»Ÿè®¡æ€»è¡Œæ•°ï¼Œå…¶å°±æ˜¯æ·»åŠ äº†ä¸€åˆ—éƒ½æ˜¯å¸¸é‡</li>
<li>MYISAMå­˜å‚¨ä¸‹ï¼Œcountï¼ˆ*ï¼‰çš„æ•ˆç‡é«˜  INNODBå­˜å‚¨ä¸‹  count(**)ä¸ count(1)ä¸€æ ·</li>
</ul>
</li>
<li>å’Œåˆ†ç»„å‡½æ•°ä¸€åŒæŸ¥è¯¢çš„å­—æ®µæœ‰é™åˆ¶ï¼Œè¦æ±‚æ˜¯group  by  åçš„å­—æ®µ</li>
</ul>
<h2 id="åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰ï¼š"><a href="#åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰ï¼š" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰ï¼š"></a>åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰ï¼š</h2><p>åº”ç”¨åœºæ™¯ï¼šå½“è¦æ˜¾ç¤ºçš„æ•°æ®ï¼Œä¸€é¡µæ˜¾ç¤ºä¸å…¨ï¼Œéœ€è¦åˆ†é¡µæäº¤sqlè¯·æ±‚ã€‚</p>
<p>limitï¼ˆoffsetï¼Œsizeï¼‰ï¼šoffsetè¦æ˜¾ç¤ºçš„èµ·å§‹ç´¢å¼•<font color='red'>ï¼ˆä»0å¼€å§‹ï¼‰</font>ï¼Œsizeè¦æ˜¾ç¤ºçš„æ¡ç›®ä¸ªæ•°</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>limitè¯­å¥è¦æ”¾åœ¨æŸ¥è¯¢çš„æœ€å</li>
<li>å…¬å¼ï¼š<ul>
<li>è¦æ˜¾ç¤ºçš„é¡µæ•°pageï¼Œæ¯é¡µçš„æ¡ç›®æ•°sizeã€‚ select æŸ¥è¯¢åˆ—è¡¨  from  è¡¨  limit ï¼ˆpage-1ï¼‰*sizeï¼Œsizeï¼›</li>
</ul>
</li>
</ul>
<p>æŸ¥è¯¢è¯­å¥ä¸­çš„å…³é”®å­—å’Œé¡ºåºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select *         7</span><br><span class="line">from è¡¨          1</span><br><span class="line">join è¡¨2         2</span><br><span class="line">on è¿æ¥æ¡ä»¶       3</span><br><span class="line">where  ç­›é€‰æ¡ä»¶   4</span><br><span class="line">group by å­—æ®µ    5</span><br><span class="line">having  ç­›é€‰æ¡    6</span><br><span class="line">order by  å­—     8</span><br><span class="line">limit            9</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
</search>
